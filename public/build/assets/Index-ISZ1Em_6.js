import{j as e,C as x,u as _,a as C,r as n,H as w,I as S,T as E,B as I,b as P,z as c}from"./app-DKvCPZNh.js";import{A}from"./AuthenticatedLayout-CdcuvAGy.js";import{r as j}from"./index-BrkHYILb.js";import"./ApplicationLogo-CFGAQSg_.js";import"./tslib.es6-Bb5J6d_G.js";function T({plans:i=[],subscription:a=null}){if(!i.length)return e.jsx("p",{children:"No plans available."});const o=i.filter(s=>s.active&&(!s.is_custom||a&&s.id===a.plan_id));return e.jsxs("div",{className:"space-y-5",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Company Plans"}),e.jsx("div",{className:"grid md:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-5",children:o.map(s=>{const d=a&&s.id===a.plan_id;return e.jsx(j.Card,{className:`rounded-2xl shadow-sm border-2 transition hover:shadow-md ${d?"border-primary":"border-gray-200"}`,children:e.jsxs(j.CardBody,{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s.name}),s.is_custom?e.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full",children:"Custom"}):null]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Employees Included:"}),e.jsx("p",{className:"font-medium",children:s.cards_included})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"NFC Cards Included:"}),e.jsx("p",{className:"font-medium",children:s.nfc_cards_included})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Price:"}),e.jsxs("p",{className:"font-medium",children:[e.jsxs("span",{className:"font-bold mr-1",children:["€",s.price_monthly]}),"/month or"," ",e.jsxs("span",{className:"font-bold ml-1",children:["€",s.price_annual]}),"/year"]})]}),e.jsx("div",{children:d?e.jsx(x,{variant:"secondary",className:"w-full",disabled:!0,children:"Subscribed"}):e.jsx(x,{variant:"primary",className:"w-full",onClick:()=>window.open("mailto:admin@ppsbusinesscards.de?subject=Plan%20Inquiry&body=I%20would%20like%20to%20subscribe%20to%20the%20plan:%20"+s.name,"_blank"),children:"Contact Admin"})})]})},s.id)})})]})}function L(){const{plans:i,company:a,subscription:o}=_().props,{setHeaderTitle:s,setHeaderText:d}=C(),[b,u]=n.useState({}),[p,h]=n.useState(!1),[y,g]=n.useState({name:a?.name??"",billing_email:a?.billing_email??"",street_address:a?.street_address??"",postal_code:a?.postal_code??"",city:a?.city??"",country:a?.country??"",vat_id:a?.vat_id??"",created_at:a?.created_at??"",updated_at:a?.updated_at??""});n.useEffect(()=>{s("Settings"),d("")},[]);const f=(l,t)=>{g(r=>({...r,[l]:t??""}))},N=async l=>{l.preventDefault(),u({}),h(!0);try{const{data:t}=await P.put(route("settings.company.update"),y,{headers:{Accept:"application/json"}});t.success?(c.success(t.message||"Company details updated successfully."),g(r=>({...r,...Object.fromEntries(Object.entries(t.company||{}).map(([m,v])=>[m,v??""]))}))):c.error(t.message||"Failed to update company details.")}catch(t){t.response?.status===422?(u(t.response.data.errors||{}),c.error("Please fix the highlighted errors.")):c.error(t.response?.data?.message||"Something went wrong. Try again later.")}finally{h(!1)}};return e.jsxs(A,{children:[e.jsx(w,{title:"Settings"}),e.jsx("form",{onSubmit:N,className:"py-4 md:px-6 px-4",children:e.jsxs("div",{className:"py-4 md:px-6 px-4 rounded-[14px] main-box bg-white flex flex-col gap-6",children:[e.jsx(T,{plans:i,subscription:o}),e.jsxs("div",{className:"space-y-5",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Company Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid xl:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-3",children:[{name:"name",label:"Company Name"},{name:"billing_email",label:"Billing Email"},{name:"street_address",label:"Street Address"},{name:"postal_code",label:"Postal Code"},{name:"city",label:"City"},{name:"country",label:"Country"},{name:"vat_id",label:"VAT ID"}].map(({name:l,label:t,disabled:r})=>e.jsxs("div",{className:"space-y-1",children:[e.jsx(S,{htmlFor:l,className:"leading-tight",value:t}),e.jsx(E,{id:l,name:l,value:y[l]??"",onChange:m=>f(l,m.target.value),className:"w-full block",disabled:r}),e.jsx(I,{message:b[l]})]},l))}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(x,{type:"submit",variant:"primary",disabled:p,children:p?"Saving...":"Save changes"})})]})]})]})})]})}export{L as default};
