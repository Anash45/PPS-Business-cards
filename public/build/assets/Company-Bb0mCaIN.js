import{b as v,c as j,r as i,j as a,H as A,d as C,e as D,z as o,f as E}from"./app-571qQf3A.js";import{A as $}from"./AuthenticatedLayout-Co8XJb9F.js";import{E as l,D as w}from"./dataTables.dataTables-6HyKFa3h.js";import{D as N,a as c}from"./DropdownUi-BJwWZhlD.js";import{g as S}from"./viteConfig-BIBuROsR.js";import"./ApplicationLogo-Bveg2Iib.js";l.use(w);function M(){const{cards:p,isSubscriptionActive:u}=v().props,{setHeaderTitle:m,setHeaderText:f}=j(),[d,x]=i.useState("https://app.ppsbusinesscards.de");i.useEffect(()=>{(async()=>{const t=await S();x(t),console.log("asdsad",t)})()},[]),i.useEffect(()=>{m("Cards Management"),f("")},[]);const g=(t,r,e)=>{const s=document.createElement("div");return setTimeout(()=>{C.createRoot(s).render(a.jsxs(N,{children:[a.jsx(c,{onClick:()=>window.location.href=`/company/cards/${e.id}/edit`,children:"Edit"}),a.jsx(c,{onClick:()=>b(e.id,e.status),children:e.status==="active"?"Set Inactive":"Set Active"})]}))},0),s},b=async(t,r)=>{const e=r==="active"?"inactive":"active";if(confirm(`Are you sure you want to set this card as ${e}?`))try{const s=await D.put(`/cards/${t}/toggle-status`,{status:e});s.data?.success?(o.success(s.data.message||"Card status updated successfully."),E.reload({only:["cards"]})):o.error(s.data?.message||"Failed to update card status.")}catch(s){if(s.response&&s.response.data){const n=s.response.data;n.message?o.error(n.message):n.errors?Object.values(n.errors).forEach(h=>{o.error(h)}):o.error("An unexpected error occurred.")}else o.error("Network error or server is unreachable.")}},y=i.useMemo(()=>[{title:"ID",data:"id"},{title:"Code",data:"code",render:(t,r,e)=>`<a href="${d}/card/${t}" target="_blank" class="text-[#50bd5b] underline">${t}</a>`},{title:"Name",data:null,render:(t,r,e)=>[e.salutation,e.title,e.first_name,e.last_name].filter(Boolean).join(" ")},{title:"Position",data:"position"},{title:"Department",data:"department"},{title:"Status",data:"status",render:t=>{const r=t==="active";return`<span class="px-2 py-1 text-xs font-medium rounded-full ${r?"bg-green-100 text-green-700 border border-green-200":"bg-gray-100 text-gray-700 border border-gray-200"}">${r?"Active":"Inactive"}</span>`}},{title:"Actions",data:null,orderable:!1,searchable:!1,render:g}],[d]);return a.jsxs($,{children:[a.jsx(A,{title:"Cards"}),a.jsx("div",{className:"py-4 md:px-6 px-4 flex flex-col gap-6",children:u?a.jsx("div",{className:"space-y-5",children:a.jsx("div",{className:"py-4 md:px-6 px-4 rounded-[14px] bg-white flex flex-col gap-3",children:a.jsx(l,{data:p,columns:y,className:"display site-datatable",options:{responsive:!0,pageLength:10,lengthMenu:[10,25,50,100],dom:"<'flex justify-between items-center mb-3 sd-top'<'flex items-center gap-2'l><'flex items-center gap-2'f>>rt<'flex justify-center mt-3 sd-bottom'p>"}},d)})}):a.jsx("div",{className:"p-4 bg-red-100 text-red-700 rounded-md",children:"You can only access this page with a valid subscription. Contact Admin for more information."})})]})}export{M as default};
