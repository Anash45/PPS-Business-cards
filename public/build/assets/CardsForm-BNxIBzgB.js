import{b as j,r as l,j as a,I as c,S as N,T as x,B as g,D as v,e as b,n as m,f as _}from"./app-BVPepYtD.js";import{g as q}from"./viteConfig-BIBuROsR.js";import D from"./CardsPreview-CtY1ajtB.js";import"./dayjs.min-DbabgLc9.js";function L({previewCards:n,setPreviewCards:o}){const{companies:i}=j().props,[r,y]=l.useState("https://app.ppsbusinesscards.de"),[u,p]=l.useState(!1),[t,d]=l.useState({company_id:i.length>0?i[0].id:"",quantity:10,domain:r});l.useEffect(()=>{(async()=>{const e=await q();y(e),d(s=>({...s,domain:e}))})()},[]);const f=()=>o([]),h=async e=>{e.preventDefault(),p(!0),o([]);try{const s=await b.post("/cards",{company_id:t.company_id,quantity:t.quantity});s.data.success?(o(s.data.createdCards),console.log(s.data),m.success(`${s.data.cards_created} cards generated successfully!`),_.reload({only:["cardsGroups"]})):m.error(s.data.message||"Failed to generate cards")}catch(s){console.error(s),m.error(s.response?.data?.message||"Failed to generate cards")}finally{p(!1)}};return console.log(n),a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:h,className:"grid gap-3 md:grid-cols-2 grid-cols-1",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(c,{htmlFor:"company",value:"Company",className:"text-[#344054] font-medium"}),a.jsx(N,{id:"company",name:"company_id",value:t.company_id,onChange:e=>d({...t,company_id:e.target.value}),className:"w-full block",options:i.map(e=>({value:e.id,label:`${e.name} -- ${e.used_cards}/${e.total_cards_allowed}`}))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(c,{htmlFor:"quantity",value:"Number of cards",className:"text-[#344054] font-medium"}),a.jsx(x,{id:"quantity",name:"quantity",type:"number",value:t.quantity,onChange:e=>d({...t,quantity:e.target.value}),className:"block w-full",required:!0})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(c,{htmlFor:"domain",value:"Domain (read-only)",className:"text-[#344054] font-medium"}),a.jsx(x,{id:"domain",name:"domain",value:r,readOnly:!0,className:"block w-full"})]}),a.jsxs("div",{className:"flex-wrap gap-1 items-center md:col-span-2 flex mt-3",children:[a.jsx(g,{type:"submit",disabled:u,children:u?"Generating...":"Generate Cards"}),a.jsx(g,{variant:"light",type:"button",onClick:f,children:"Clear Preview"})]})]}),n.length>0&&a.jsxs("div",{className:"flex flex-col gap-3 py-3",children:[a.jsxs("p",{className:"text-[#079E04] text-xs font-medium",children:[n.length," URLs generated."]}),a.jsx("p",{className:"text-xs leading-5 font-medium text-[#475569]",children:"Once generated, the URLs are immediately active. The CSV is automatically downloaded and stored in the History."}),a.jsx(v,{className:"mt-3"})]}),n.length>0&&a.jsx(D,{domain:r,previewCards:n})]})}export{L as default};
