import{u as C,a as $,r as d,j as e,H as D,d as m}from"./app-Dd_QPlgy.js";import{A as M}from"./AuthenticatedLayout-B-uWGfmf.js";import{g as P}from"./viteConfig-gEqUb4HH.js";import{W as A}from"./WalletStatusPill-C5nV3pRz.js";import{S as W,W as x}from"./SyncingWarning-CWCvYBI6.js";import{u as w,a as T}from"./useJobMonitor-BdlJyAV4.js";import{C as H}from"./CustomDataTable-CNfg0zUu.js";import{E as L}from"./eye-BANaW6rT.js";import{S as R}from"./square-pen-CiePXX6m.js";import{M as I}from"./mail-YCX5cQdA.js";import{T as J}from"./trash-2-C2Hq6G0w.js";import"./ApplicationLogo-CT8GBDDt.js";import"./chevron-down-Ch36OhRN.js";function ee(){const{cards:u,isSubscriptionActive:p,hasRunningJob:l,hasRunningEmailJob:n}=C().props,{setHeaderTitle:g,setHeaderText:b}=$(),[c,h]=d.useState("https://app.ppsbusinesscards.de");w(l),T(n),d.useEffect(()=>{(async()=>{const t=await P();h(t)})()},[]),d.useEffect(()=>{g("Employees Management"),b("")},[]);const f=t=>{if(!t)return null;const s=new Date(t),r=o=>o<10?`0${o}`:`${o}`,i=`${r(s.getDate())}.${r(s.getMonth()+1)}.${s.getFullYear()}`;let a=s.getHours();const S=r(s.getMinutes()),k=a>=12?"PM":"AM";a=a%12,a===0&&(a=12);const E=`${a}:${S} ${k}`;return{dateStr:i,timeStr:E}},y=[{key:"id",label:"ID",sortable:!0,render:t=>e.jsxs("span",{className:"font-medium",children:["#",t]})},{key:"code",label:"Code",sortable:!0,render:t=>e.jsx("a",{href:`${c}/card/${t}`,target:"_blank",rel:"noopener noreferrer",className:"text-[#50bd5b] underline hover:text-[#3da147]",children:t})},{key:"first_name",label:"User",sortable:!0,render:(t,s)=>{const i=[s.salutation,s.title,s.first_name,s.last_name].filter(Boolean).join(" ")||"Not assigned";return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:s.profile_image?`/storage/${s.profile_image}`:"/assets/images/profile-placeholder.png",alt:"Profile",className:"rounded-full border-2 bg-white border-white w-8 h-8 object-cover shrink-0"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"font-medium text-[#181D27] text-sm",children:i}),s.primary_email&&e.jsx("p",{className:"text-xs text-gray-600",children:s.primary_email})]})]})}},{key:"position",label:"Position",sortable:!0,render:t=>t||e.jsx("span",{className:"text-gray-400",children:"—"})},{key:"department",label:"Department",sortable:!0,render:t=>t||e.jsx("span",{className:"text-gray-400",children:"—"})},{key:"last_email_sent",label:"Notified",sortable:!0,render:t=>{console.log("Last Email Sent:",t);const s=f(t);return s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-700 border border-green-200",children:"Sent"}),e.jsxs("div",{className:"flex flex-col leading-tight text-xs",children:[e.jsx("span",{children:s.dateStr}),e.jsx("span",{className:"text-gray-500",children:s.timeStr})]})]}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-700 border border-red-200",children:"Never"})}},{key:"status",label:"Status",sortable:!0,render:t=>{const s=t==="active";return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${s?"bg-green-100 text-green-700 border border-green-200":"bg-red-100 text-red-700 border border-red-200"}`,children:s?"Active":"Inactive"})}},{key:"wallet_status",label:"Wallet",sortable:!0,render:(t,s)=>(console.log(s),e.jsxs("div",{className:"flex gap-1 items-center flex-wrap",children:[e.jsx(x,{eligibility:s?.is_eligible_for_sync?.eligible}),s.is_syncing&&Number(s.is_syncing)===1?e.jsx(WalletSyncingPill,{}):e.jsx(A,{status:s?.wallet_status?.status})]}))},{key:"wallet_eligibility",label:"Eligibility",sortable:!0,render:t=>e.jsx(x,{status:t})},{key:"actions",label:"Actions",sortable:!1,className:"text-right",headerClassName:"text-right",render:(t,s)=>e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:()=>j(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"View Card",children:e.jsx(L,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>N(s),className:"p-2 text-gray-600 hover:bg-gray-50 rounded transition-colors",title:"Edit Card",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>v(s),className:"p-2 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Send Email",children:e.jsx(I,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_(s),className:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete Card",children:e.jsx(J,{className:"h-4 w-4"})})]})}],j=t=>{window.open(`${c}/card/${t.code}`,"_blank")},N=t=>{m.visit(route("cards.edit",t.id))},v=t=>{console.log("Send email to:",t)},_=t=>{confirm(`Are you sure you want to delete the card for ${t.first_name} ${t.last_name}?`)&&m.delete(route("cards.destroy",t.id))};return e.jsxs(M,{children:[e.jsx(D,{title:"Employee Cards"}),e.jsxs("div",{className:"py-4 md:px-6 px-4 flex flex-col gap-6",children:[(l||n)&&e.jsx(W,{hasWalletSync:l,hasEmailSync:n}),p?e.jsx("div",{className:"space-y-5",children:e.jsxs("div",{className:"py-4 md:px-6 px-4 rounded-[14px] bg-white flex flex-col gap-3",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Employee Cards"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage your company's employee business cards"})]}),e.jsx(H,{columns:y,data:u,endpoint:route("company.cards1"),tableKey:"cards",searchable:!0,paginated:!0,perPageOptions:[10,25,50,100],emptyMessage:"No employee cards found. Create your first card to get started."})]})}):e.jsx("div",{className:"p-4 bg-red-100 text-red-700 rounded-md",children:"You can only access this page with a valid subscription. Contact Admin for more information."})]})]})}export{ee as default};
