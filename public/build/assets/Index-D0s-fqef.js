import{a as Y,r as c,d as u,j as t,H as v}from"./app-umLenybF.js";import{A as w}from"./AuthenticatedLayout-DsVDCguY.js";import{C as _}from"./CustomDataTable-DlK_LzGF.js";import{r as S,d as m}from"./dayjs.min-Ddt2WoyQ.js";import{D as M,a as j}from"./DropdownUi-BXiKe4Ub.js";import"./ApplicationLogo-CeYBK0qu.js";import"./chevron-down-Cc5z-C0P.js";var g={exports:{}},J=g.exports,D;function C(){return D||(D=1,(function(l,h){(function(b,i){l.exports=i(S())})(J,(function(b){function i(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var o=i(b),p={s:"ein paar Sekunden",m:["eine Minute","einer Minute"],mm:"%d Minuten",h:["eine Stunde","einer Stunde"],hh:"%d Stunden",d:["ein Tag","einem Tag"],dd:["%d Tage","%d Tagen"],M:["ein Monat","einem Monat"],MM:["%d Monate","%d Monaten"],y:["ein Jahr","einem Jahr"],yy:["%d Jahre","%d Jahren"]};function a(s,f,e){var r=p[e];return Array.isArray(r)&&(r=r[f?0:1]),r.replace("%d",s)}var x={name:"de",weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._März_Apr._Mai_Juni_Juli_Aug._Sept._Okt._Nov._Dez.".split("_"),ordinal:function(s){return s+"."},weekStart:1,yearStart:4,formats:{LTS:"HH:mm:ss",LT:"HH:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"vor %s",s:a,m:a,mm:a,h:a,hh:a,d:a,dd:a,M:a,MM:a,y:a,yy:a}};return o.default.locale(x,null,!0),x}))})(g)),g.exports}C();function k(l){return!l||typeof l!="string"?"":l.charAt(0).toUpperCase()+l.slice(1)}m.locale("de");function $({walletJobs:l,emailJobs:h}){const{setHeaderTitle:b,setHeaderText:i}=Y(),[o,p]=c.useState("wallet");c.useEffect(()=>{b("Background Jobs"),i("Track wallet sync and email sending jobs")},[]),c.useEffect(()=>{const e=setInterval(()=>{u.reload({only:["walletJobs","emailJobs"]})},1e4);return()=>clearInterval(e)},[]);const a=c.useMemo(()=>[{key:"id",label:"ID",sortable:!0},{key:"status",label:"Status",sortable:!0,render:e=>{let r="bg-gray-100 text-gray-700 border-gray-200";return e==="completed"?r="bg-green-100 text-green-700 border-green-200":e==="processing"?r="bg-blue-100 text-blue-700 border-blue-200":e==="failed"?r="bg-red-100 text-red-700 border-red-200":e==="pending"&&(r="bg-yellow-100 text-yellow-700 border-yellow-200"),t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${r}`,children:k(e)})}},{key:"progress",label:"Progress",sortable:!1,render:(e,r)=>{const n=r.total_items||0,d=r.processed_items||0,y=n>0?Math.round(d/n*100):0;return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:t.jsx("div",{className:"bg-blue-500 h-full transition-all",style:{width:`${y}%`}})}),t.jsxs("span",{className:"text-xs font-medium",children:[d,"/",n]})]})}},{key:"last_processed_at",label:"Last Processed",sortable:!0,render:e=>e?m(e).format("DD.MM.YYYY HH:mm"):"—"},{key:"reason",label:"Reason",sortable:!1,render:e=>e||"—"},{key:"created_at",label:"Created",sortable:!0,render:e=>m(e).format("DD.MM.YYYY HH:mm")},{key:"actions",label:"Actions",sortable:!1,render:(e,r)=>r.status==="pending"||r.status==="processing"?t.jsx(M,{children:t.jsx(j,{onClick:()=>s(r.id),children:"Cancel"})}):t.jsx("span",{className:"text-gray-400 text-xs",children:"—"})}],[]),x=c.useMemo(()=>[{key:"id",label:"ID",sortable:!0},{key:"status",label:"Status",sortable:!0,render:e=>{let r="bg-gray-100 text-gray-700 border-gray-200";return e==="completed"?r="bg-green-100 text-green-700 border-green-200":e==="processing"?r="bg-blue-100 text-blue-700 border-blue-200":e==="failed"?r="bg-red-100 text-red-700 border-red-200":e==="pending"&&(r="bg-yellow-100 text-yellow-700 border-yellow-200"),t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${r}`,children:k(e)})}},{key:"progress",label:"Progress",sortable:!1,render:(e,r)=>{const n=r.total_items||0,d=r.processed_items||0,y=n>0?Math.round(d/n*100):0;return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:t.jsx("div",{className:"bg-green-500 h-full transition-all",style:{width:`${y}%`}})}),t.jsxs("span",{className:"text-xs font-medium",children:[d,"/",n]})]})}},{key:"last_processed_at",label:"Last Processed",sortable:!0,render:e=>e?m(e).format("DD.MM.YYYY HH:mm"):"—"},{key:"reason",label:"Reason",sortable:!1,render:e=>e||"—"},{key:"created_at",label:"Created",sortable:!0,render:e=>m(e).format("DD.MM.YYYY HH:mm")},{key:"actions",label:"Actions",sortable:!1,render:(e,r)=>r.status==="pending"||r.status==="processing"?t.jsx(M,{children:t.jsx(j,{onClick:()=>f(r.id),children:"Cancel"})}):t.jsx("span",{className:"text-gray-400 text-xs",children:"—"})}],[]),s=e=>{confirm("Are you sure you want to cancel this wallet sync job?")&&u.post(route("background-jobs.wallet.cancel",e),{},{preserveScroll:!0,onSuccess:()=>{u.reload({only:["walletJobs"]})}})},f=e=>{confirm("Are you sure you want to cancel this email sending job?")&&u.post(route("background-jobs.email.cancel",e),{},{preserveScroll:!0,onSuccess:()=>{u.reload({only:["emailJobs"]})}})};return t.jsxs(w,{children:[t.jsx(v,{title:"Background Jobs"}),t.jsx("div",{className:"py-4 md:px-6 px-4 flex flex-col gap-6",children:t.jsxs("div",{className:"bg-white rounded-[14px] p-4 md:p-6",children:[t.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[t.jsx("button",{onClick:()=>p("wallet"),className:`px-6 py-3 font-medium text-sm border-b-2 transition-colors ${o==="wallet"?"border-[#698F6D] text-[#698F6D]":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Wallet Sync Jobs"}),t.jsx("button",{onClick:()=>p("email"),className:`px-6 py-3 font-medium text-sm border-b-2 transition-colors ${o==="email"?"border-[#698F6D] text-[#698F6D]":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Email Sending Jobs"})]}),t.jsxs("div",{className:"overflow-auto",style:{maxHeight:"700px"},children:[o==="wallet"&&t.jsx(_,{columns:a,data:l,endpoint:route("background-jobs.index"),tableKey:"walletJobs",searchable:!0,paginated:!0,perPageOptions:[10,25,50],size:"sm"}),o==="email"&&t.jsx(_,{columns:x,data:h,endpoint:route("background-jobs.index"),tableKey:"emailJobs",searchable:!0,paginated:!0,perPageOptions:[10,25,50],size:"sm"})]})]})})]})}export{$ as default};
