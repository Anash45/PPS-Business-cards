import{r as c,b as u,z as t,d as m,j as a}from"./app-lsU9ifOx.js";import{d as n}from"./dayjs.min-BC7sp2Os.js";import{C as _}from"./CustomDataTable-BAeqO14y.js";import{T as l}from"./trash-2-62mmuE_3.js";import{D as j}from"./download-B86z1yCF.js";import{E as g}from"./eye-DBSYeyHy.js";import"./chevron-down-Hrg1Vc3W.js";function Y({independentCards:f,cardsGroups:x=null,independentGroups:p=null,setPreviewCards:h}){const d=c.useCallback((s,e)=>{const r=s.map(N=>({...N,company:e&&e.company?{id:e.company.id,name:e.company.name,billing_email:e.company.billing_email}:null}));h(r)},[h]),i=c.useCallback(async s=>{if(confirm("Are you sure? It will only be deleted if there are no active cards."))try{const e=await u.delete(route("cards.groups.destroy",s));e.data.success?(t.success(e.data.message),m.reload({only:["cardsGroups","companies"]})):t.error(e.data.message||"Failed to delete group.")}catch(e){t.error(e.response?.data?.message||"Failed to delete group.")}},[]),b=c.useCallback(async s=>{if(confirm("Are you sure? This will delete all normal cards in this group."))try{const e=await u.delete(route("cards.group.deleteCards",s));e.data.success?(t.success(e.data.message),m.reload({only:["cardsGroups","companies"]})):t.error(e.data.message||"Failed to delete normal cards.")}catch(e){t.error(e.response?.data?.message||"Failed to delete normal cards.")}},[]),o=c.useCallback(async s=>{if(confirm("Are you sure? This will delete all NFC cards in this group."))try{const e=await u.delete(route("cards.group.deleteNfcCards",s));e.data.success?(t.success(e.data.message),m.reload({only:["cardsGroups","companies"]})):t.error(e.data.message||"Failed to delete NFC cards.")}catch(e){t.error(e.response?.data?.message||"Failed to delete NFC cards.")}},[]),y=c.useMemo(()=>f?[{key:"created_at",label:"Created At",sortable:!0,render:(s,e)=>a.jsxs("div",{className:"text-xs",children:[n(e.created_at).format("DD.MM.YYYY"),a.jsx("br",{}),n(e.created_at).format("HH:mm")]})},{key:"title",label:"Title",sortable:!0,render:(s,e)=>e.title||"-"},{key:"nfc_cards_count",label:"NFC Cards",sortable:!0,className:"text-center",render:(s,e)=>a.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[a.jsx("span",{children:e.nfc_cards_count}),a.jsx("button",{onClick:()=>o(e.id),className:"text-red-600",title:"Delete NFC cards",children:a.jsx(l,{size:16,strokeWidth:2})})]})},{key:"actions",label:"Actions",sortable:!1,className:"text-center",render:(s,e)=>a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("a",{target:"_blank",href:e.nfc_cards&&e.nfc_cards.length>0?route("cards.group.download",e.id):"#",onClick:r=>{(!e.nfc_cards||e.nfc_cards.length===0)&&(r.preventDefault(),t("Only NFC cards are available for preview/download.",{icon:"ℹ️"}))},className:`inline-flex items-center ${!e.nfc_cards||e.nfc_cards.length===0?"opacity-50 cursor-pointer":"text-body hover:text-blue-600"}`,children:a.jsx(j,{size:16,strokeWidth:2})}),a.jsx("button",{onClick:()=>{if(!e.nfc_cards||e.nfc_cards.length===0){t("Only NFC cards are available for preview/download.",{icon:"ℹ️"});return}d(e.nfc_cards,e)},className:`text-blue-600 ${!e.nfc_cards||e.nfc_cards.length===0?"opacity-40 cursor-pointer":""}`,children:a.jsx(g,{size:16,strokeWidth:2})}),a.jsx("button",{onClick:()=>i(e.id),className:"text-red-600",children:a.jsx(l,{size:16,strokeWidth:2})})]})}]:[{key:"created_at",label:"Created At",sortable:!0,render:(s,e)=>a.jsxs("div",{className:"text-xs",children:[n(e.created_at).format("DD.MM.YYYY"),a.jsx("br",{}),n(e.created_at).format("HH:mm")]})},{key:"company.name",label:"Company",sortable:!0,render:(s,e)=>e.company?.name||"-"},{key:"cards_count",label:"Employees",sortable:!0,className:"text-center",render:(s,e)=>a.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[a.jsx("span",{children:e.cards_count}),a.jsx("button",{onClick:()=>b(e.id),className:"text-red-600",title:"Delete normal cards",children:a.jsx(l,{size:16,strokeWidth:2})})]})},{key:"nfc_cards_count",label:"NFC Cards",sortable:!0,className:"text-center",render:(s,e)=>a.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[a.jsx("span",{children:e.nfc_cards_count}),a.jsx("button",{onClick:()=>o(e.id),className:"text-red-600",title:"Delete NFC cards",children:a.jsx(l,{size:16,strokeWidth:2})})]})},{key:"actions",label:"Actions",sortable:!1,className:"text-center",render:(s,e)=>a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("a",{target:"_blank",href:e.nfc_cards&&e.nfc_cards.length>0?route("cards.group.download",e.id):"#",onClick:r=>{(!e.nfc_cards||e.nfc_cards.length===0)&&(r.preventDefault(),t("Only NFC cards are available for preview/download.",{icon:"ℹ️"}))},className:`inline-flex items-center ${!e.nfc_cards||e.nfc_cards.length===0?"opacity-50 cursor-pointer":"text-body hover:text-blue-600"}`,children:a.jsx(j,{size:16,strokeWidth:2})}),a.jsx("button",{onClick:()=>{if(!e.nfc_cards||e.nfc_cards.length===0){t("Only NFC cards are available for preview/download.",{icon:"ℹ️"});return}d(e.nfc_cards,e)},className:`text-blue-600 ${!e.nfc_cards||e.nfc_cards.length===0?"opacity-40 cursor-pointer":""}`,children:a.jsx(g,{size:16,strokeWidth:2})}),a.jsx("button",{onClick:()=>i(e.id),className:"text-red-600",children:a.jsx(l,{size:16,strokeWidth:2})})]})}],[f,b,o,i,d]);return console.log("cardsGroups:",x),a.jsx("div",{className:"overflow-auto w-full max-h-[730px]",children:p?a.jsx(_,{columns:y,data:p,endpoint:route("cards.index"),tableKey:"independentGroups",searchable:!0,paginated:!0,perPageOptions:[10,25,50],className:"text-xs",size:"md"}):a.jsx(_,{columns:y,data:x,endpoint:route("cards.index"),tableKey:"cardsGroups",searchable:!0,paginated:!0,perPageOptions:[10,25,50],className:"text-xs",size:"md"})})}export{Y as default};
