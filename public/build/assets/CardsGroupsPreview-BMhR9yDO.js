import{j as t,D as n,b as d,z as o,d as l}from"./app-CD7xEUUc.js";import{d as C}from"./dayjs.min-Js-uEFT6.js";import{E as m,D as j}from"./dataTables.dataTables-CAENn0Te.js";import{T as c}from"./trash-2-CYliyoEq.js";import{D as b}from"./download-CGIMQ0Ax.js";import{E as N}from"./eye-DK4Sc92M.js";m.use(j);function W({previewGroups:u,setPreviewCards:p}){const f=(a,e)=>{const s=a.map(r=>({...r,company:{id:e.id,name:e.name,billing_email:e.billing_email}}));p(s)},h=async a=>{if(confirm("Are you sure? It will only be deleted if there are no active cards."))try{const e=await d.delete(route("cards.groups.destroy",a));e.data.success?(o.success(e.data.message),l.reload({only:["cardsGroups","companies"]})):o.error(e.data.message||"Failed to delete group.")}catch(e){o.error(e.response?.data?.message||"Failed to delete group.")}},x=async a=>{if(confirm("Are you sure? This will delete all normal cards in this group."))try{const e=await d.delete(route("cards.group.deleteCards",a));e.data.success?(o.success(e.data.message),l.reload({only:["cardsGroups","companies"]})):o.error(e.data.message||"Failed to delete normal cards.")}catch(e){o.error(e.response?.data?.message||"Failed to delete normal cards.")}},g=async a=>{if(confirm("Are you sure? This will delete all NFC cards in this group."))try{const e=await d.delete(route("cards.group.deleteNfcCards",a));e.data.success?(o.success(e.data.message),l.reload({only:["cardsGroups","companies"]})):o.error(e.data.message||"Failed to delete NFC cards.")}catch(e){o.error(e.response?.data?.message||"Failed to delete NFC cards.")}},y=[{title:"Created At",data:"created_at",render:a=>C(a).format("DD.MM.YYYY, HH:mm")},{title:"Company",data:"company.name"},{title:"Cards",data:null,orderable:!1,searchable:!1,render:(a,e,s)=>{const r=document.createElement("div");return r.className="flex items-center gap-2 justify-center",setTimeout(()=>{n.createRoot(r).render(t.jsxs(t.Fragment,{children:[t.jsx("span",{children:s.cards_count}),t.jsx("button",{onClick:()=>x(s.id),className:"text-red-600",title:"Delete normal cards",children:t.jsx(c,{size:16,strokeWidth:2})})]}))},0),r}},{title:"NFC Cards",data:null,orderable:!1,searchable:!1,render:(a,e,s)=>{const r=document.createElement("div");return r.className="flex items-center gap-2 justify-center",setTimeout(()=>{n.createRoot(r).render(t.jsxs(t.Fragment,{children:[t.jsx("span",{children:s.nfc_cards_count}),t.jsx("button",{onClick:()=>g(s.id),className:"text-red-600",title:"Delete NFC cards",children:t.jsx(c,{size:16,strokeWidth:2})})]}))},0),r}},{title:"Actions",data:null,orderable:!1,searchable:!1,render:(a,e,s)=>{const r=document.createElement("div");return r.className="flex gap-2 justify-center",setTimeout(()=>{n.createRoot(r).render(t.jsxs(t.Fragment,{children:[t.jsx("a",{target:"_blank",href:route("cards.group.download",s.id),children:t.jsx(b,{size:16,className:"text-body",strokeWidth:2})}),t.jsx("button",{onClick:()=>f(s.nfc_cards,s.company),disabled:!s.nfc_cards||s.nfc_cards.length===0,className:`text-blue-600 ${!s.nfc_cards||s.nfc_cards.length===0?"opacity-40 cursor-not-allowed":""}`,children:t.jsx(N,{size:16,strokeWidth:2})}),t.jsx("button",{onClick:()=>h(s.id),className:"text-red-600",children:t.jsx(c,{size:16,strokeWidth:2})})]}))},0),r}}];return t.jsx("div",{className:"overflow-auto w-full max-h-[730px]",children:t.jsx(m,{data:u,columns:y,paging:!0,searching:!1,ordering:!0,options:{responsive:!0,pageLength:10,dom:"<'flex justify-between items-center mb-3 sd-top'<'flex items-center gap-2'l><'flex items-center gap-2'f>>rt<'flex justify-center mt-3 sd-bottom'p>"},defaultOrder:[0,"desc"],className:"display site-datatable text-xs"})})}export{W as default};
