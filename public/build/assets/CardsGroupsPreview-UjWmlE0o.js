import{j as r,D as o,z as n,b as d,d as c}from"./app-BV87h2Bw.js";import{d as b}from"./dayjs.min-XJyiNODD.js";import{E as m,D as j}from"./dataTables.dataTables-Drcj2WKE.js";import{T as l}from"./trash-2-DRc36BJQ.js";import{D as N}from"./download-C0vECv6W.js";import{E as _}from"./eye-DmPK6ETG.js";m.use(j);function G({previewGroups:u,setPreviewCards:f}){const p=(a,e)=>{const t=a.map(s=>({...s,company:{id:e.id,name:e.name,billing_email:e.billing_email}}));f(t)},h=async a=>{if(confirm("Are you sure? It will only be deleted if there are no active cards."))try{const e=await d.delete(route("cards.groups.destroy",a));e.data.success?(n.success(e.data.message),c.reload({only:["cardsGroups","companies"]})):n.error(e.data.message||"Failed to delete group.")}catch(e){n.error(e.response?.data?.message||"Failed to delete group.")}},x=async a=>{if(confirm("Are you sure? This will delete all normal cards in this group."))try{const e=await d.delete(route("cards.group.deleteCards",a));e.data.success?(n.success(e.data.message),c.reload({only:["cardsGroups","companies"]})):n.error(e.data.message||"Failed to delete normal cards.")}catch(e){n.error(e.response?.data?.message||"Failed to delete normal cards.")}},g=async a=>{if(confirm("Are you sure? This will delete all NFC cards in this group."))try{const e=await d.delete(route("cards.group.deleteNfcCards",a));e.data.success?(n.success(e.data.message),c.reload({only:["cardsGroups","companies"]})):n.error(e.data.message||"Failed to delete NFC cards.")}catch(e){n.error(e.response?.data?.message||"Failed to delete NFC cards.")}},y=[{title:"Created At",data:"created_at",render:(a,e,t)=>e==="sort"||e==="type"?new Date(a).getTime():b(a).format("DD.MM.YYYY, HH:mm")},{title:"Company",data:"company.name"},{title:"Cards",data:null,orderable:!1,searchable:!1,render:(a,e,t)=>{const s=document.createElement("div");return s.className="flex items-center gap-2 justify-center",setTimeout(()=>{o.createRoot(s).render(r.jsxs(r.Fragment,{children:[r.jsx("span",{children:t.cards_count}),r.jsx("button",{onClick:()=>x(t.id),className:"text-red-600",title:"Delete normal cards",children:r.jsx(l,{size:16,strokeWidth:2})})]}))},0),s}},{title:"NFC Cards",data:null,orderable:!1,searchable:!1,render:(a,e,t)=>{const s=document.createElement("div");return s.className="flex items-center gap-2 justify-center",setTimeout(()=>{o.createRoot(s).render(r.jsxs(r.Fragment,{children:[r.jsx("span",{children:t.nfc_cards_count}),r.jsx("button",{onClick:()=>g(t.id),className:"text-red-600",title:"Delete NFC cards",children:r.jsx(l,{size:16,strokeWidth:2})})]}))},0),s}},{title:"Actions",data:null,orderable:!1,searchable:!1,render:(a,e,t)=>{const s=document.createElement("div");return s.className="flex gap-2 justify-center",setTimeout(()=>{o.createRoot(s).render(r.jsxs(r.Fragment,{children:[r.jsx("a",{target:"_blank",href:t.nfc_cards&&t.nfc_cards.length>0?route("cards.group.download",t.id):"#",onClick:C=>{(!t.nfc_cards||t.nfc_cards.length===0)&&(C.preventDefault(),n("Only NFC cards are available for preview/download.",{icon:"ℹ️"}))},className:`inline-flex items-center ${!t.nfc_cards||t.nfc_cards.length===0?"opacity-50 cursor-pointer":"text-body hover:text-blue-600"}`,children:r.jsx(N,{size:16,strokeWidth:2})}),r.jsx("button",{onClick:()=>{if(!t.nfc_cards||t.nfc_cards.length===0){n("Only NFC cards are available for preview/download.",{icon:"ℹ️"});return}p(t.nfc_cards,t.company)},className:`text-blue-600 ${!t.nfc_cards||t.nfc_cards.length===0?"opacity-40 cursor-pointer":""}`,children:r.jsx(_,{size:16,strokeWidth:2})}),r.jsx("button",{onClick:()=>h(t.id),className:"text-red-600",children:r.jsx(l,{size:16,strokeWidth:2})})]}))},0),s}}];return r.jsx("div",{className:"overflow-auto w-full max-h-[730px]",children:r.jsx(m,{data:u,columns:y,paging:!0,searching:!1,ordering:!0,options:{responsive:!0,pageLength:10,dom:"<'flex justify-between items-center mb-3 sd-top'<'flex items-center gap-2'l><'flex items-center gap-2'f>>rt<'flex justify-center mt-3 sd-bottom'p>"},defaultOrder:[0,"desc"],className:"display site-datatable text-xs"})})}export{G as default};
