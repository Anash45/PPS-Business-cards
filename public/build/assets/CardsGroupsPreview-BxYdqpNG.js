import{r as t,b as c,z as r,d,j as a}from"./app--JcDETcA.js";import{d as x}from"./dayjs.min-DWR1O0Is.js";import{C as b}from"./CustomDataTable-BoI33ZaV.js";import{T as n}from"./trash-2-eJVFPFxW.js";import{D as g}from"./download-DrAe4q_e.js";import{E as C}from"./eye-Cy2Za765.js";import"./chevron-down-IfYr0Qrc.js";function z({cardsGroups:o,setPreviewCards:i}){const u=t.useCallback((s,e)=>{const l=s.map(y=>({...y,company:{id:e.id,name:e.name,billing_email:e.billing_email}}));i(l)},[i]),m=t.useCallback(async s=>{if(confirm("Are you sure? It will only be deleted if there are no active cards."))try{const e=await c.delete(route("cards.groups.destroy",s));e.data.success?(r.success(e.data.message),d.reload({only:["cardsGroups","companies"]})):r.error(e.data.message||"Failed to delete group.")}catch(e){r.error(e.response?.data?.message||"Failed to delete group.")}},[]),p=t.useCallback(async s=>{if(confirm("Are you sure? This will delete all normal cards in this group."))try{const e=await c.delete(route("cards.group.deleteCards",s));e.data.success?(r.success(e.data.message),d.reload({only:["cardsGroups","companies"]})):r.error(e.data.message||"Failed to delete normal cards.")}catch(e){r.error(e.response?.data?.message||"Failed to delete normal cards.")}},[]),f=t.useCallback(async s=>{if(confirm("Are you sure? This will delete all NFC cards in this group."))try{const e=await c.delete(route("cards.group.deleteNfcCards",s));e.data.success?(r.success(e.data.message),d.reload({only:["cardsGroups","companies"]})):r.error(e.data.message||"Failed to delete NFC cards.")}catch(e){r.error(e.response?.data?.message||"Failed to delete NFC cards.")}},[]),h=t.useMemo(()=>[{key:"created_at",label:"Created At",sortable:!0,render:(s,e)=>a.jsxs("div",{className:"text-xs",children:[x(e.created_at).format("DD.MM.YYYY"),a.jsx("br",{}),x(e.created_at).format("HH:mm")]})},{key:"company",label:"Company",sortable:!0,render:(s,e)=>e.company?.name||"-"},{key:"cards_count",label:"Employees",sortable:!1,className:"text-center",render:(s,e)=>a.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[a.jsx("span",{children:e.cards_count}),a.jsx("button",{onClick:()=>p(e.id),className:"text-red-600",title:"Delete normal cards",children:a.jsx(n,{size:16,strokeWidth:2})})]})},{key:"nfc_cards_count",label:"NFC Cards",sortable:!1,className:"text-center",render:(s,e)=>a.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[a.jsx("span",{children:e.nfc_cards_count}),a.jsx("button",{onClick:()=>f(e.id),className:"text-red-600",title:"Delete NFC cards",children:a.jsx(n,{size:16,strokeWidth:2})})]})},{key:"actions",label:"Actions",sortable:!1,className:"text-center",render:(s,e)=>a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("a",{target:"_blank",href:e.nfc_cards&&e.nfc_cards.length>0?route("cards.group.download",e.id):"#",onClick:l=>{(!e.nfc_cards||e.nfc_cards.length===0)&&(l.preventDefault(),r("Only NFC cards are available for preview/download.",{icon:"ℹ️"}))},className:`inline-flex items-center ${!e.nfc_cards||e.nfc_cards.length===0?"opacity-50 cursor-pointer":"text-body hover:text-blue-600"}`,children:a.jsx(g,{size:16,strokeWidth:2})}),a.jsx("button",{onClick:()=>{if(!e.nfc_cards||e.nfc_cards.length===0){r("Only NFC cards are available for preview/download.",{icon:"ℹ️"});return}u(e.nfc_cards,e.company)},className:`text-blue-600 ${!e.nfc_cards||e.nfc_cards.length===0?"opacity-40 cursor-pointer":""}`,children:a.jsx(C,{size:16,strokeWidth:2})}),a.jsx("button",{onClick:()=>m(e.id),className:"text-red-600",children:a.jsx(n,{size:16,strokeWidth:2})})]})}],[p,f,m,u]);return console.log("cardsGroups:",o),a.jsx("div",{className:"overflow-auto w-full max-h-[730px]",children:a.jsx(b,{columns:h,data:o,endpoint:route("cards.index"),tableKey:"cardsGroups",searchable:!0,paginated:!0,perPageOptions:[10,25,50],className:"text-xs",size:"md"})})}export{z as default};
