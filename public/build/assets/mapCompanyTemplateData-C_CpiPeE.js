import{g as $,j as a,c as p,r as h,n as E,e as k}from"./app-CeHC17CF.js";import{g as P}from"./viteConfig-BIBuROsR.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],A=$("smile",C);function D({cardSocialsLinks:r}){return r?.length?a.jsx("div",{className:"flex items-center gap-2 flex-wrap justify-center",children:(r||[]).map((e,n)=>e.url&&a.jsx("a",{href:e.url||"#",target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-gray-700 transition",children:a.jsx("img",{src:`/assets/images/icons/${e.icon.replace(/^Fa/,"").toLowerCase()}.png`,alt:e.icon,className:"h-7"})},n))}):null}function R({cardPhones:r}){const{isCardReal:e,cardFormData:n}=p(),o=r?.filter(s=>!s.is_hidden),t=o&&o.length>0?o:[{label:"Sample",phone_number:"+44 1234 567890",is_hidden:!1}];return a.jsx("div",{className:"grid gap-2 grid-cols-1",children:t.map((s,c)=>a.jsxs("a",{target:"_blank",href:`tel:${s.phone_number}`,style:{color:n?.phone_text_color??n?.btn_text_color,backgroundColor:n?.phone_bg_color??n?.btn_bg_color,borderColor:n?.phone_bg_color??n?.btn_bg_color},className:"flex relative border text-sm leading-tight items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn w-full",children:[a.jsx("span",{className:"shrink-0 text-xl",children:"ðŸ“ž"}),a.jsxs("span",{children:[s.label?a.jsxs("span",{className:"capitalize",children:[s.label,": "]}):null," ",s.phone_number]}),s.is_hidden&&a.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"})]},c))})}function B({cardEmails:r}){const{isCardReal:e,cardFormData:n}=p(),o=r?.filter(s=>!s.is_hidden),t=o&&o.length>0?o:[{label:"Sample",email:"sample@email.com",is_hidden:!1}];return a.jsx("div",{className:"grid gap-2 grid-cols-1",children:t.map((s,c)=>a.jsxs("a",{target:"_blank",href:`mailto:${s.email}`,style:{color:n?.email_text_color??n?.btn_text_color,backgroundColor:n?.email_bg_color??n?.btn_bg_color,borderColor:n?.email_bg_color??n?.btn_bg_color},className:"flex border text-sm leading-tight relative items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[a.jsx("span",{className:"shrink-0 text-xl",children:"âœ‰ï¸"}),a.jsxs("span",{children:[s.label?a.jsxs("span",{className:"capitalize",children:[s.label,": "]}):null,s.email]}),s.is_hidden?a.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},c))})}function F({cardAddresses:r}){const{isCardReal:e,cardFormData:n}=p(),o=r?.filter(t=>!t.is_hidden);return o?.length>0?a.jsx("div",{className:"grid gap-2 grid-cols-1",children:o.map((t,s)=>t.is_hidden&&e?null:a.jsxs("a",{target:"_blank",href:`https://www.google.com/maps/search/?api=1&query=${t.address}`,style:{color:n?.address_text_color??n?.btn_text_color,backgroundColor:n?.address_bg_color??n?.btn_bg_color,borderColor:n?.address_bg_color??n?.btn_bg_color},className:"flex border text-sm leading-tight relative items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[a.jsx("span",{className:"shrink-0 text-xl",children:"ðŸ“"}),a.jsxs("span",{children:[t.label?a.jsxs("span",{class:"capitalize",children:[t.label,": "]}):""," ",[t.street,t.house].filter(Boolean).join(" "),", ",[t.zip,t.city].filter(Boolean).join(" "),", ",t.country||""]}),t.is_hidden?a.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},s))}):null}function L({cardButtons:r}){const{cardFormData:e}=p();return r?.length>0?a.jsx("div",{className:"grid gap-2 grid-cols-1",children:r.map((n,o)=>n.button_text&&a.jsxs("a",{target:"_blank",href:n.button_link,style:{color:e?.btn_text_color,backgroundColor:e?.btn_bg_color,borderColor:e?.btn_bg_color??"#87B88C"},className:"flex border text-sm leading-tight items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[a.jsx("span",{className:"shrink-0 text-xl",children:n.icon?n.icon:a.jsx(A,{className:"h-7 w-7"})}),a.jsx("span",{children:n.button_text})]},o))}):null}function I(){const{cardFormData:r}=p(),[e,n]=h.useState("https://app.ppsbusinesscards.de");h.useEffect(()=>{(async()=>{const c=await P();n(c)})()},[]);const o=async()=>{if(!r)return;console.log("cardFormData: ",r);const c=r.first_name||"",_=r.last_name||"",b=r.company_name||"";let i=`BEGIN:VCARD
VERSION:3.0
N:${_};${c};;${r.title||""};
FN:${[r.salutation,c,_].filter(Boolean).join(" ")}
ORG:${b}
TITLE:${r.position||""}
ROLE:${r.department||""}
`;if(r.profile_image_url)try{const l=await t(`${e}${r.profile_image_url}`);if(l){const m=s(r.profile_image_url);i+=`PHOTO;ENCODING=b;TYPE=${m}:${l}
`}}catch(l){console.warn("Failed to convert image to base64, falling back to URL:",l),i+=`PHOTO;VALUE=URI:${e}${r.profile_image_url}
`}(r.card_websites||[]).forEach(l=>{l.url&&(l.label?i+=`URL;TYPE=${l.label.toUpperCase()}:${l.url}
`:i+=`URL:${l.url}
`)}),(r.card_phone_numbers||[]).forEach((l,m)=>{if(l.phone_number){const g=(l.type||"Work").toUpperCase();i+=`TEL;TYPE=${m===0?"PREF,":""}${g},VOICE:${l.phone_number}
`}}),(r.card_emails||[]).forEach((l,m)=>{if(l.email){const g=(l.type||"Work").toUpperCase();i+=`EMAIL;TYPE=${m===0?"PREF,":""}${g}:${l.email}
`}}),(r.card_addresses||[]).forEach((l,m)=>{if(l.street||l.house||l.city||l.country){const g=(l.type||"Work").toUpperCase(),f=m===0?"PREF,":"",j=[l.street,l.house].filter(Boolean).join(" "),v=l.city||"",w=l.zip||"",N=l.country||"";i+=`ADR;TYPE=${f}${g}:;;${j};${v};;${w};${N}
`}}),i+="END:VCARD";const u=new Blob([i],{type:"text/vcard;charset=utf-8"}),x=URL.createObjectURL(u),d=document.createElement("a"),y=b.replace(/\s+/g,"_");d.download=`${c}_${_}_${y}.vcf`,d.href=x,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(x),E.success("vCard downloaded!");try{const l=await k.post("/cards/increment-downloads",{code:r.code});l.data.success?console.log("Downloads updated:",l.data.downloads):console.warn("Download increment failed:",l.data.message)}catch(l){console.error("Error incrementing downloads:",l)}},t=c=>new Promise((_,b)=>{const i=new Image;i.crossOrigin="Anonymous",i.onload=()=>{const u=document.createElement("canvas"),x=u.getContext("2d");u.width=i.width,u.height=i.height,x.drawImage(i,0,0);try{const d=u.toDataURL("image/jpeg").split(",")[1];_(d)}catch(d){b(d)}},i.onerror=b,i.src=c,i.complete&&i.onload()}),s=c=>{const _=c.split(".").pop()?.toLowerCase()||"jpeg";return{jpg:"JPEG",jpeg:"JPEG",png:"PNG",gif:"GIF",bmp:"BMP",webp:"WEBP"}[_]||"JPEG"};return a.jsx("div",{className:"flex items-center justify-center",children:a.jsx("button",{onClick:o,style:{color:r?.vcard_btn_text_color||r?.btn_text_color||"#ffffff",backgroundColor:r?.vcard_btn_bg_color||r?.btn_bg_color||"#87B88C",borderColor:r?.vcard_btn_bg_color||r?.btn_bg_color||"#87B88C"},className:"px-4 py-2.5 rounded-[10px] text-sm font-medium leading-tight w-fit",children:r.contact_btn_text})})}function T({cardWebsites:r}){const{cardFormData:e}=p(),n=r?.filter(o=>!o.is_hidden);return n?.length?a.jsx("div",{className:"grid gap-2 grid-cols-1",children:n.map((o,t)=>a.jsxs("a",{href:o.url?.startsWith("http")?o.url:`https://${o.url}`,target:"_blank",rel:"noopener noreferrer",style:{color:e?.website_text_color??e?.btn_text_color,backgroundColor:e?.website_bg_color??e?.btn_bg_color,borderColor:e?.website_bg_color??e?.btn_bg_color},className:"flex border text-sm leading-tight relative items-center gap-3 justify-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[a.jsx("span",{className:"shrink-0 text-xl",children:"ðŸŒ"}),a.jsx("span",{className:"truncate",children:o.label?a.jsx("span",{className:"capitalize",children:o.label}):o.url}),o.is_hidden?a.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},t))}):null}function W({isReal:r=!1}){const{cardFormData:e,setCardFormData:n}=p();return a.jsx("div",{className:`border ${r?"border-transparent":"border-[#EAECF0]"} rounded-lg p-3 mx-auto w-[430px] max-w-full`,style:{backgroundColor:e?.card_bg_color??"#ffffff"},children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative border border-[#EAECF0] bg-gradient bg-gradient-to-b from-[#eaffec] to-transparent rounded-lg w-full h-[200px]",children:[e.banner_image_url?a.jsx("img",{src:e.banner_image_url,alt:"Banner",className:"w-full h-full object-cover rounded-lg"}):null,e.profile_image_url?a.jsx("img",{src:e.profile_image_url,alt:"Profile",className:"rounded-full border-2 bg-white border-white absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2 w-[140px] h-[140px] object-cover"}):a.jsx("img",{src:"/assets/images/profile-placeholder.png",alt:"Profile",className:"rounded-full border-2 bg-white border-white absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2 w-[140px] h-[140px] object-cover"})]}),a.jsx("div",{children:a.jsxs("div",{className:"mt-20 space-y-2 text-center",children:[a.jsx("h2",{className:"text-xl text-center leading-tight font-black font-public-sans",style:{color:e?.name_text_color||"#000000"},children:e.title||e.first_name||e.last_name?`${e?.title} ${e?.first_name} ${e?.last_name}`:"Mr. John Doe"}),e.degree?a.jsx("p",{className:"text-sm italic leading-tight font-bold",style:{color:e?.name_text_color||"#000000"},children:e.degree}):null,e.position||e.department||e.company_name?a.jsxs("div",{className:"space-y-1",style:{color:e?.company_text_color||"#000000"},children:[e.position||e.department?a.jsxs("p",{className:"text-sm font-medium flex items-center justify-center gap-1.5",children:[a.jsx("span",{children:e?.position})," ",a.jsx("span",{className:"inline-block h-1 w-1 opacity-30 rounded-full",style:{backgroundColor:e?.company_text_color||"#000000"}}),a.jsx("span",{children:e?.department})]}):null,e.company_name?a.jsx("p",{className:"text-base leading-tight font-bold",children:e.company_name}):null]}):null]})}),a.jsx(I,{}),a.jsx(D,{cardSocialsLinks:e?.card_social_links??[]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(R,{cardPhones:e?.card_phone_numbers??[]}),a.jsx(B,{cardEmails:e?.card_emails??[]}),a.jsx(T,{cardWebsites:e?.card_websites??[]}),a.jsx(F,{cardAddresses:e?.card_addresses??[]}),a.jsx(L,{cardButtons:e?.card_buttons??[]})]})]})})}function S(r,e,n={}){if(console.log("Mapping company template data for:",r,e),!r)return{};const o=r?.card_template;return{name_text_color:o?.name_text_color??"#000000",company_name:o?.company_name??r?.name??"",contact_btn_text:o?.contact_btn_text??"Save contact details",company_text_color:o?.company_text_color??"#000000",card_bg_color:o?.card_bg_color??"#ffffff",btn_bg_color:o?.btn_bg_color??"#87B88C",btn_text_color:o?.btn_text_color??"#ffffff",phone_bg_color:o?.phone_bg_color??"#87B88C",phone_text_color:o?.phone_text_color??"#ffffff",email_bg_color:o?.email_bg_color??"#87B88C",email_text_color:o?.email_text_color??"#ffffff",address_bg_color:o?.address_bg_color??"#87B88C",address_text_color:o?.address_text_color??"#ffffff",website_bg_color:o?.website_bg_color??"#87B88C",website_text_color:o?.website_text_color??"#ffffff",contact_btn_text:o?.contact_btn_text??"Save card",vcard_btn_bg_color:o.vcard_btn_bg_color,vcard_btn_text_color:o.vcard_btn_text_color,banner_image:null,banner_image_url:o?.banner_image?`/storage/${o.banner_image}`:null,...e?{code:e.code??"",salutation:e.salutation??"",title:e.title??"",first_name:e.first_name??"",last_name:e.last_name??"",degree:e.degree??"",position:e.position??"",department:e.department??"",profile_image_url:e?.profile_image?`/storage/${e.profile_image}`:"/assets/images/profile-placeholder.png",profile_image:null}:{},card_social_links:Array.isArray(r?.card_social_links)?r.card_social_links.map(t=>({id:t.id||null,icon:t.icon||"",url:t.url||"",company_id:t.company_id||null,card_id:t.card_id||null})):[],card_phone_numbers:Array.isArray(r?.card_phone_numbers)?r.card_phone_numbers.map(t=>({id:t.id||null,phone_number:t.phone_number||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||""})):[],card_emails:Array.isArray(r?.card_emails)?r.card_emails.map(t=>({id:t.id||null,email:t.email||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||""})):[],card_addresses:Array.isArray(r?.card_addresses)?r.card_addresses.map(t=>({id:t.id||null,street:t.street||"",house_number:t.house_number||"",zip:t.zip||"",city:t.city||"",country:t.country||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||""})):[],card_buttons:Array.isArray(r?.card_buttons)?r.card_buttons.map(t=>({id:t.id||null,button_text:t.button_text||"",button_link:t.button_link||"",icon:t.icon||"",company_id:t.company_id||null,card_id:t.card_id||null})):[],card_websites:Array.isArray(r?.card_websites)?r.card_websites.map(t=>({id:t.id||null,url:t.url||"",is_hidden:t.is_hidden??!1,company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||""})):[]}}export{W as C,A as S,S as m};
