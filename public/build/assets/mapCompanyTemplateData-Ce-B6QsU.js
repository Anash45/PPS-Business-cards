import{g as P,j as a,r as p,c as w,n as D,e as E}from"./app-C1BmwRVp.js";import{g as R}from"./viteConfig-BIBuROsR.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],S=P("smile",L);function z({cardSocialsLinks:n}){return n?.length?a.jsx("div",{className:"flex items-center gap-2 flex-wrap justify-center",children:(n||[]).map((r,l)=>r.url&&a.jsx("a",{href:r.url||"#",target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-gray-700 transition",children:r.icon?a.jsx("img",{src:`/assets/images/icons/${r.icon.replace(/^Fa/,"").toLowerCase()}.png`,alt:r.icon,className:"h-7"}):null},l))}):null}const k=p.createContext();function W({children:n}){const r=(navigator.language||"en").split("-")[0],[l,e]=p.useState(r==="de"?"de":"en"),[t,s]=p.useState(!1),o=p.useRef(null),i=[{code:"en",label:"English",flag:"/assets/images/uk.png"},{code:"de",label:"Deutsch",flag:"/assets/images/germany.png"}],m=i.find(u=>u.code===l)||i[0],d=l==="de",b=u=>{e(u),s(!1)};return p.useEffect(()=>{const u=_=>{o.current&&!o.current.contains(_.target)&&s(!1)};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[]),a.jsxs(k.Provider,{value:{lang:l,setLang:e,isDE:d},children:[n,a.jsx("div",{className:"fixed top-4 right-4 z-50",ref:o,children:a.jsxs("div",{className:"relative",children:[t&&a.jsx("div",{className:"absolute top-12 right-0 mb-2 w-36 rounded-2xl shadow-lg bg-white border border-gray-200 transition-all duration-150",children:i.map(u=>a.jsxs("button",{onClick:()=>b(u.code),className:`flex items-center w-full px-3 py-2 text-sm hover:bg-gray-100 ${u.code===l?"font-semibold text-primary":"text-gray-700"}`,children:[a.jsx("img",{src:u.flag,alt:u.label,className:"h-4 w-4 mr-2"}),u.label]},u.code))}),a.jsx("button",{onClick:()=>s(!t),className:"w-12 h-12 rounded-full shadow-md bg-primary text-white flex items-center justify-center text-xl hover:bg-primary focus:outline-none",title:"Change language",children:a.jsx("img",{src:m.flag,alt:m.label,className:"h-6 w-6 rounded-full"})})]})})]})}function v(){return p.useContext(k)}function C({text:n}){const l=v()?.lang||null,[e,t]=p.useState(n),[s,o]=p.useState(!1),i=p.useRef(n),m=p.useRef({});p.useEffect(()=>{i.current=n,l||t(n)},[n,l]);const d=async _=>{try{return(await(await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=en&dt=t&q=${encodeURIComponent(_)}`)).json())[2]||"en"}catch{return"en"}},b=async(_,f,c)=>{const g=`${f}->${c}:${_}`;if(m.current[g])return m.current[g];try{const x=(await(await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${f}&tl=${c}&dt=t&q=${encodeURIComponent(_)}`)).json())[0][0][0];return m.current[g]=x,x}catch{return _}},u=async(_,f)=>{if(!/<[^>]+>/.test(_)){const x=await d(_);return x===f?_:await b(_,x,f)}const g=/>([^<]+)</g,h=[..._.matchAll(g)];let y=_;for(let x of h){const j=x[1].trim();if(!j)continue;const N=await d(j);let $=j;N!==f&&($=await b(j,N,f)),y=y.replace(j,$)}return y};return p.useEffect(()=>{if(!l)return;(async()=>{o(!0);const f=await u(i.current,l);t(f),o(!1)})()},[l,n]),a.jsx("span",{style:{whiteSpace:"pre-wrap"},dangerouslySetInnerHTML:{__html:s?"...":e}})}function A(){const{cardFormData:n}=w(),[r,l]=p.useState("https://app.ppsbusinesscards.de");p.useEffect(()=>{(async()=>{const o=await R();l(o)})()},[]);const e=async()=>{if(!n)return;console.log("cardFormData: ",n);const o=n.first_name||"",i=n.last_name||"",m=n.company_name||"";let d=`BEGIN:VCARD
VERSION:3.0
N:${i};${o};;${n.title||""};
FN:${[n.salutation,o,i].filter(Boolean).join(" ")}
ORG:${m}
TITLE:${n.position||""}
ROLE:${n.department||""}
`;if(n.profile_image_url)try{const c=await t(`${r}${n.profile_image_url}`);if(c){const g=s(n.profile_image_url);d+=`PHOTO;ENCODING=b;TYPE=${g}:${c}
`}}catch(c){console.warn("Failed to convert image to base64, falling back to URL:",c),d+=`PHOTO;VALUE=URI:${r}${n.profile_image_url}
`}(n.card_websites||[]).forEach(c=>{c.url&&(c.label?d+=`URL;TYPE=${c.label.toUpperCase()}:${c.url}
`:d+=`URL:${c.url}
`)}),(n.card_phone_numbers||[]).forEach((c,g)=>{if(c.phone_number){const h=(c.type||"Work").toUpperCase();d+=`TEL;TYPE=${g===0?"PREF,":""}${h},VOICE:${c.phone_number}
`}}),(n.card_emails||[]).forEach((c,g)=>{if(c.email){const h=(c.type||"Work").toUpperCase();d+=`EMAIL;TYPE=${g===0?"PREF,":""}${h}:${c.email}
`}}),(n.card_addresses||[]).forEach((c,g)=>{if(c.street||c.house_number||c.city||c.country){const h=(c.type||"Work").toUpperCase(),y=g===0?"PREF,":"",x=[c.street,c.house_number].join(" "),j=c.city||"",N=c.zip||"",$=c.country||"";d+=`ADR;TYPE=${y}${h}:;;${x};${j};;${N};${$}
`}}),d+="END:VCARD";const b=new Blob([d],{type:"text/vcard;charset=utf-8"}),u=URL.createObjectURL(b),_=document.createElement("a"),f=m.replace(/\s+/g,"_");_.download=`${o}_${i}_${f}.vcf`,_.href=u,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(u),D.success("vCard downloaded!");try{const c=await E.post("/cards/increment-downloads",{code:n.code});c.data.success?console.log("Downloads updated:",c.data.downloads):console.warn("Download increment failed:",c.data.message)}catch(c){console.error("Error incrementing downloads:",c)}},t=o=>new Promise((i,m)=>{const d=new Image;d.crossOrigin="Anonymous",d.onload=()=>{const b=document.createElement("canvas"),u=b.getContext("2d");b.width=d.width,b.height=d.height,u.drawImage(d,0,0);try{const _=b.toDataURL("image/jpeg").split(",")[1];i(_)}catch(_){m(_)}},d.onerror=m,d.src=o,d.complete&&d.onload()}),s=o=>{const i=o.split(".").pop()?.toLowerCase()||"jpeg";return{jpg:"JPEG",jpeg:"JPEG",png:"PNG",gif:"GIF",bmp:"BMP",webp:"WEBP"}[i]||"JPEG"};return a.jsx("div",{className:"flex items-center justify-center",children:a.jsx("button",{onClick:e,style:{color:n?.vcard_btn_text_color||n?.btn_text_color||"#ffffff",backgroundColor:n?.vcard_btn_bg_color||n?.btn_bg_color||"#87B88C",borderColor:n?.vcard_btn_bg_color||n?.btn_bg_color||"#87B88C"},className:"px-4 py-2.5 rounded-[10px] text-sm font-medium leading-tight w-fit",children:a.jsx(C,{text:n.contact_btn_text})})})}function T({cardPhones:n}){const l=v()?.isDE||null,{isCardReal:e,cardFormData:t}=w(),s=n?.filter(i=>!i.is_hidden),o=s&&s.length>0?s:[{label:"Sample",phone_number:"+44 1234 567890",is_hidden:!1}];return a.jsx("div",{className:"grid gap-2 grid-cols-1",children:o.map((i,m)=>a.jsxs("a",{target:"_blank",href:`tel:${i.phone_number}`,style:{color:t?.phone_text_color??t?.btn_text_color,backgroundColor:t?.phone_bg_color??t?.btn_bg_color,borderColor:t?.phone_bg_color??t?.btn_bg_color,fontSize:`${t.buttons_size}px`},className:"flex relative border leading-tight items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn w-full",children:[a.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(t.buttons_size)+4}px`},children:"ðŸ“ž"}),a.jsxs("span",{children:[i.label||i.label_de?a.jsx("span",{children:l&&i.label_de?i.label_de:i.label}):null," ",i.phone_number]}),i.is_hidden&&a.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"})]},m))})}function B({cardEmails:n}){const l=v()?.isDE||null,{isCardReal:e,cardFormData:t}=w(),s=n?.filter(i=>!i.is_hidden),o=s&&s.length>0?s:[{label:"Sample",email:"sample@email.com",is_hidden:!1}];return a.jsx("div",{className:"grid gap-2 grid-cols-1",children:o.map((i,m)=>a.jsxs("a",{target:"_blank",href:`mailto:${i.email}`,style:{color:t?.email_text_color??t?.btn_text_color,backgroundColor:t?.email_bg_color??t?.btn_bg_color,borderColor:t?.email_bg_color??t?.btn_bg_color,fontSize:`${t.buttons_size}px`},className:"flex border leading-tight relative items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[a.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(t.buttons_size)+4}px`},children:"âœ‰ï¸"}),a.jsxs("span",{children:[i.label||i.label_de?a.jsx("span",{children:l&&i.label_de?i.label_de:i.label}):null,i.email]}),i.is_hidden?a.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},m))})}function F({cardWebsites:n}){const l=v()?.isDE||null,{cardFormData:e}=w(),t=n?.filter(s=>!s.is_hidden);return t?.length?a.jsx("div",{className:"grid gap-2 grid-cols-1",children:t.map((s,o)=>a.jsxs("a",{href:s.url?.startsWith("http")?s.url:`https://${s.url}`,target:"_blank",rel:"noopener noreferrer",style:{color:e?.website_text_color??e?.btn_text_color,backgroundColor:e?.website_bg_color??e?.btn_bg_color,borderColor:e?.website_bg_color??e?.btn_bg_color,fontSize:`${e.buttons_size}px`},className:"flex border leading-tight relative items-center gap-3 justify-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[a.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(e.buttons_size)+4}px`},children:s.icon?a.jsx("span",{children:s.icon}):a.jsx("span",{children:"ðŸŒ"})}),a.jsx("span",{className:"truncate",children:s.label||s.label_de?a.jsx("span",{children:l&&s.label_de?s.label_de:s.label}):s.url}),s.is_hidden?a.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},o))}):null}function I({cardAddresses:n}){const{isCardReal:r,cardFormData:l}=w(),t=v()?.isDE||null,s=n?.filter(o=>!o.is_hidden);return s?.length>0?a.jsx("div",{className:"grid gap-2 grid-cols-1",children:s.map((o,i)=>o.is_hidden&&r?null:a.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:`https://www.google.de/maps/search/?api=1&query=${encodeURIComponent([o.street,o.house_number,o.zip,o.city,o.country].filter(Boolean).join(" "))}`,style:{color:l?.address_text_color??l?.btn_text_color,backgroundColor:l?.address_bg_color??l?.btn_bg_color,borderColor:l?.address_bg_color??l?.btn_bg_color,fontSize:`${l.buttons_size}px`},className:"flex border leading-tight relative items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[a.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(l.buttons_size)+4}px`},children:"ðŸ“"}),a.jsx("span",{children:o.label||o.label_de?a.jsx("span",{children:t&&o.label_de?o.label_de:o.label}):a.jsxs("span",{children:[[o.street,o.house_number].filter(Boolean).join(" "),o.street||o.house_number?", ":"",[o.zip,o.city].filter(Boolean).join(" "),o.zip||o.city?", ":"",o.country||""]})}),o.is_hidden?a.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},i))}):null}function O({cardButtons:n}){const l=v()?.isDE||null,{cardFormData:e}=w();return n?.length>0?a.jsx("div",{className:"grid gap-2 grid-cols-1",children:n.map((t,s)=>t.button_text&&a.jsxs("a",{target:"_blank",href:t.button_link,style:{color:e?.btn_text_color,backgroundColor:e?.btn_bg_color,borderColor:e?.btn_bg_color??"#87B88C",fontSize:`${e.buttons_size}px`},className:"flex border leading-tight items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[a.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(e.buttons_size)+4}px`},children:t.icon?t.icon:a.jsx(S,{className:"h-7 w-7"})}),a.jsx("span",{children:l&&t.button_text_de?t.button_text_de:t.button_text})]},s))}):null}function U(){const{cardFormData:n,cardSectionsOrder:r,setCardSectionsOrder:l}=w(),e=["phoneNumbers","emails","websites","addresses","buttons"];p.useEffect(()=>{n?.company_id&&(r&&r.length>0||E.get(`/company/${n.company_id}/card-sections-order`).then(o=>{o.data.order&&Array.isArray(o.data.order)?l(o.data.order):l(e)}).catch(o=>{console.warn("âš ï¸ Failed to fetch card section order:",o),l(e)}))},[n?.company_id]);const t={phoneNumbers:a.jsx(T,{cardPhones:n?.card_phone_numbers??[]},"phoneNumbers"),emails:a.jsx(B,{cardEmails:n?.card_emails??[]},"emails"),websites:a.jsx(F,{cardWebsites:n?.card_websites??[]},"websites"),addresses:a.jsx(I,{cardAddresses:n?.card_addresses??[]},"addresses"),buttons:a.jsx(O,{cardButtons:n?.card_buttons??[]},"buttons")},s=r?.length?r:e;return a.jsx("div",{className:"space-y-2",children:s.map(o=>t[o]??null)})}function G({isReal:n=!1}){const l=v()?.isDE||null,{cardFormData:e}=w(),t=p.useRef(null),s=p.useRef(null),[o,i]=p.useState(!0);return p.useEffect(()=>{const m=()=>{if(t.current&&s.current){const d=t.current.getBoundingClientRect(),b=s.current.getBoundingClientRect();i(Math.abs(d.top-b.top)<5)}};return m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[e?.position,e?.department]),a.jsx("div",{className:`border ${n?"border-transparent":"border-[#EAECF0]"} rounded-lg p-3 mx-auto w-[430px] max-w-full`,style:{backgroundColor:e?.card_bg_color??"#ffffff"},children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative border border-[#EAECF0] bg-gradient bg-gradient-to-b from-[#eaffec] to-transparent rounded-lg w-full",children:[e.banner_image_url?a.jsx("img",{src:e.banner_image_url,alt:"Banner",className:"w-full h-full object-cover rounded-lg aspect-[2/1]"}):a.jsx("img",{src:"/assets/images/white-placeholder.webp",alt:"Banner",className:"w-full h-full object-cover rounded-lg aspect-[2/1]"}),e.profile_image_url?a.jsx("img",{src:e.profile_image_url,alt:"Profile",className:"rounded-full border-2 bg-white border-white absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2 w-[140px] h-[140px] object-cover"}):a.jsx("img",{src:"/assets/images/profile-placeholder.png",alt:"Profile",className:"rounded-full border-2 bg-white border-white absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2 w-[140px] h-[140px] object-cover"})]}),a.jsx("div",{children:a.jsxs("div",{className:"mt-20 space-y-2 text-center",children:[a.jsx("h2",{className:"text-xl text-center leading-tight font-black font-public-sans",style:{color:e?.name_text_color||"#000000"},children:e.title||e.first_name||e.last_name?`${e?.title} ${e?.first_name} ${e?.last_name}`:"Dr. John Doe"}),e.degree||e.degree_de?a.jsx("p",{className:"text-sm italic leading-tight font-bold",style:{color:e?.name_text_color||"#000000"},children:l&&e.degree_de?e.degree_de:e.degree}):null,(e.position||e.department||e.company_name)&&a.jsxs("div",{className:"space-y-1",style:{color:e?.company_text_color||"#000000"},children:[(e.position||e.department)&&a.jsxs("p",{className:"text-sm font-medium flex items-center justify-center flex-wrap gap-1.5 text-center",children:[l&&e.position_de||e.position?a.jsx("span",{ref:t,children:l&&e.position_de?e.position_de:e.position}):null,(l&&e.position_de||e.position)&&(l&&e.department_de||e.department)&&o?a.jsx("span",{className:"inline-block h-1 w-1 rounded-full opacity-40",style:{backgroundColor:e?.company_text_color||"#000"}}):null,l&&e.department_de||e.department?a.jsx("span",{ref:s,children:l&&e.department_de?e.department_de:e.department}):null]}),e.company_name&&a.jsx("p",{className:"text-base leading-tight font-bold",dangerouslySetInnerHTML:{__html:e.company_name.replace(/\r?\n/g,"<br>")}})]})]})}),a.jsx(A,{}),a.jsx(z,{cardSocialsLinks:e?.card_social_links??[]}),a.jsx(U,{})]})})}function q(n,r,l={}){if(console.log("Mapping company template data for:",n,r),!n)return{};const e=n?.card_template;return{company_id:e?.company_id??null,name_text_color:e?.name_text_color??"#000000",company_name:e?.company_name??n?.name??"",contact_btn_text:e?.contact_btn_text??"Save contact details",company_text_color:e?.company_text_color??"#000000",card_bg_color:e?.card_bg_color??"#ffffff",btn_bg_color:e?.btn_bg_color??"#87B88C",btn_text_color:e?.btn_text_color??"#ffffff",phone_bg_color:e?.phone_bg_color??"#87B88C",phone_text_color:e?.phone_text_color??"#ffffff",email_bg_color:e?.email_bg_color??"#87B88C",email_text_color:e?.email_text_color??"#ffffff",address_bg_color:e?.address_bg_color??"#87B88C",address_text_color:e?.address_text_color??"#ffffff",website_bg_color:e?.website_bg_color??"#87B88C",website_text_color:e?.website_text_color??"#ffffff",contact_btn_text:e?.contact_btn_text??"Save card",vcard_btn_bg_color:e?.vcard_btn_bg_color??"#87B88C",vcard_btn_text_color:e?.vcard_btn_text_color??"#ffffff",buttons_size:e?.buttons_size??"14",banner_image:null,banner_image_url:e?.banner_image?`/storage/${e.banner_image}`:null,wallet_logo_image:null,wallet_logo_image_url:e?.wallet_logo_image?`/storage/${e.wallet_logo_image}`:null,wallet_text_color:e?.wallet_text_color??"#000000",wallet_bg_color:e?.wallet_bg_color??"#c4f1c8",wallet_label_1:e?.wallet_label_1??"Name",wallet_label_2:e?.wallet_label_2??"Firmenname",wallet_label_3:e?.wallet_label_3??"Titel",wallet_qr_caption:e?.wallet_qr_caption??"QR-Code scannen",wallet_title:e?.wallet_title??"Pass Name",wallet_name:e?.wallet_name??`${e?.salutation&&e.salutation.trim()!==""?e.salutation:"Mr."} ${e?.first_name&&e.first_name.trim()!==""?e.first_name:"John"} ${e?.last_name&&e.last_name.trim()!==""?e.last_name:"Doe"}`,wallet_company_name:e?.company_name??"Firmenname",wallet_position:e?.position??"Position",wallet_qr_string:"Hello there!",...r?{code:r.code??"",salutation:r.salutation??"",title:r.title??"",first_name:r.first_name??"",last_name:r.last_name??"",degree:r.degree??"",degree_de:r.degree_de??"",position:r.position??"",position_de:r.position_de??"",department:r.department??"",department_de:r.department_de??"",profile_image_url:r?.profile_image?`/storage/${r.profile_image}`:"/assets/images/profile-placeholder.png",profile_image:null,wallet_qr_string:r?.card_wallet?.download_link??"Hello there!",wallet_name:e?.wallet_name??`${r?.salutation&&r.salutation.trim()!==""?r.salutation:"Mr."} ${r?.first_name&&r.first_name.trim()!==""?r.first_name:"John"} ${r?.last_name&&r.last_name.trim()!==""?r.last_name:"Doe"}`,wallet_position:r?.position??"Position"}:{},card_social_links:Array.isArray(n?.card_social_links)?n.card_social_links.map(t=>({id:t.id||null,icon:t.icon||"",url:t.url||"",company_id:t.company_id||null,card_id:t.card_id||null})):[],card_phone_numbers:Array.isArray(n?.card_phone_numbers)?n.card_phone_numbers.map(t=>({id:t.id||null,icon:t.icon||"",phone_number:t.phone_number||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||"",label_de:t.label_de||""})):[],card_emails:Array.isArray(n?.card_emails)?n.card_emails.map(t=>({id:t.id||null,email:t.email||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||"",label_de:t.label_de||""})):[],card_addresses:Array.isArray(n?.card_addresses)?n.card_addresses.map(t=>({id:t.id||null,street:t.street||"",house_number:t.house_number||"",zip:t.zip||"",city:t.city||"",country:t.country||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||"",label_de:t.label_de||""})):[],card_buttons:Array.isArray(n?.card_buttons)?n.card_buttons.map(t=>({id:t.id||null,button_text:t.button_text||"",button_text_de:t.button_text_de||"",button_link:t.button_link||"",icon:t.icon||"",company_id:t.company_id||null,card_id:t.card_id||null})):[],card_websites:Array.isArray(n?.card_websites)?n.card_websites.map(t=>({id:t.id||null,url:t.url||"",icon:t.icon||null,is_hidden:t.is_hidden??!1,company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||"",label_de:t.label_de||""})):[]}}export{W as A,G as C,S,C as a,q as m};
