import{g as P,j as n,r as m,c as j,n as R,e as E}from"./app-CUa8sKNu.js";import{g as C}from"./viteConfig-BIBuROsR.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],A=P("smile",L);function T({cardSocialsLinks:r}){return r?.length?n.jsx("div",{className:"flex items-center gap-2 flex-wrap justify-center",children:(r||[]).map((e,o)=>e.url&&n.jsx("a",{href:e.url||"#",target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-gray-700 transition",children:e.icon?n.jsx("img",{src:`/assets/images/icons/${e.icon.replace(/^Fa/,"").toLowerCase()}.png`,alt:e.icon,className:"h-7"}):null},o))}):null}const k=m.createContext();function z({children:r}){const e=(navigator.language||"en").split("-")[0],[o,a]=m.useState(e==="de"?"de":"en"),[t,i]=m.useState(!1),s=m.useRef(null),u=[{code:"en",label:"English",flag:"/assets/images/uk.png"},{code:"de",label:"Deutsch",flag:"/assets/images/germany.png"}],p=u.find(d=>d.code===o)||u[0],c=d=>{a(d),i(!1)};return m.useEffect(()=>{const d=h=>{s.current&&!s.current.contains(h.target)&&i(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]),n.jsxs(k.Provider,{value:{lang:o,setLang:a},children:[r,n.jsx("div",{className:"fixed top-4 right-4 z-50",ref:s,children:n.jsxs("div",{className:"relative",children:[t&&n.jsx("div",{className:"absolute top-12 right-0 mb-2 w-36 rounded-2xl shadow-lg bg-white border border-gray-200 transition-all duration-150",children:u.map(d=>n.jsxs("button",{onClick:()=>c(d.code),className:`flex items-center w-full px-3 py-2 text-sm hover:bg-gray-100 ${d.code===o?"font-semibold text-primary":"text-gray-700"}`,children:[n.jsx("img",{src:d.flag,alt:d.label,className:"h-4 w-4 mr-2"}),d.label]},d.code))}),n.jsx("button",{onClick:()=>i(!t),className:"w-12 h-12 rounded-full shadow-md bg-primary text-white flex items-center justify-center text-xl hover:bg-primary focus:outline-none",title:"Change language",children:n.jsx("img",{src:p.flag,alt:p.label,className:"h-6 w-6 rounded-full"})})]})})]})}function D(){return m.useContext(k)}function x({text:r}){const o=D()?.lang||null,[a,t]=m.useState(r),[i,s]=m.useState(!1),u=m.useRef(r),p=m.useRef({});m.useEffect(()=>{u.current=r,o||t(r)},[r,o]);const c=async _=>{try{return(await(await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=en&dt=t&q=${encodeURIComponent(_)}`)).json())[2]||"en"}catch{return"en"}},d=async(_,f,l)=>{const g=`${f}->${l}:${_}`;if(p.current[g])return p.current[g];try{const b=(await(await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${f}&tl=${l}&dt=t&q=${encodeURIComponent(_)}`)).json())[0][0][0];return p.current[g]=b,b}catch{return _}},h=async(_,f)=>{if(!/<[^>]+>/.test(_)){const b=await c(_);return b===f?_:await d(_,b,f)}const g=/>([^<]+)</g,y=[..._.matchAll(g)];let w=_;for(let b of y){const v=b[1].trim();if(!v)continue;const N=await c(v);let $=v;N!==f&&($=await d(v,N,f)),w=w.replace(v,$)}return w};return m.useEffect(()=>{if(!o)return;(async()=>{s(!0);const f=await h(u.current,o);t(f),s(!1)})()},[o,r]),n.jsx("span",{style:{whiteSpace:"pre-wrap"},dangerouslySetInnerHTML:{__html:i?"...":a}})}function B(){const{cardFormData:r}=j(),[e,o]=m.useState("https://app.ppsbusinesscards.de");m.useEffect(()=>{(async()=>{const s=await C();o(s)})()},[]);const a=async()=>{if(!r)return;console.log("cardFormData: ",r);const s=r.first_name||"",u=r.last_name||"",p=r.company_name||"";let c=`BEGIN:VCARD
VERSION:3.0
N:${u};${s};;${r.title||""};
FN:${[r.salutation,s,u].filter(Boolean).join(" ")}
ORG:${p}
TITLE:${r.position||""}
ROLE:${r.department||""}
`;if(r.profile_image_url)try{const l=await t(`${e}${r.profile_image_url}`);if(l){const g=i(r.profile_image_url);c+=`PHOTO;ENCODING=b;TYPE=${g}:${l}
`}}catch(l){console.warn("Failed to convert image to base64, falling back to URL:",l),c+=`PHOTO;VALUE=URI:${e}${r.profile_image_url}
`}(r.card_websites||[]).forEach(l=>{l.url&&(l.label?c+=`URL;TYPE=${l.label.toUpperCase()}:${l.url}
`:c+=`URL:${l.url}
`)}),(r.card_phone_numbers||[]).forEach((l,g)=>{if(l.phone_number){const y=(l.type||"Work").toUpperCase();c+=`TEL;TYPE=${g===0?"PREF,":""}${y},VOICE:${l.phone_number}
`}}),(r.card_emails||[]).forEach((l,g)=>{if(l.email){const y=(l.type||"Work").toUpperCase();c+=`EMAIL;TYPE=${g===0?"PREF,":""}${y}:${l.email}
`}}),(r.card_addresses||[]).forEach((l,g)=>{if(l.street||l.house_number||l.city||l.country){const y=(l.type||"Work").toUpperCase(),w=g===0?"PREF,":"",b=[l.street,l.house_number].join(" "),v=l.city||"",N=l.zip||"",$=l.country||"";c+=`ADR;TYPE=${w}${y}:;;${b};${v};;${N};${$}
`}}),c+="END:VCARD";const d=new Blob([c],{type:"text/vcard;charset=utf-8"}),h=URL.createObjectURL(d),_=document.createElement("a"),f=p.replace(/\s+/g,"_");_.download=`${s}_${u}_${f}.vcf`,_.href=h,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(h),R.success("vCard downloaded!");try{const l=await E.post("/cards/increment-downloads",{code:r.code});l.data.success?console.log("Downloads updated:",l.data.downloads):console.warn("Download increment failed:",l.data.message)}catch(l){console.error("Error incrementing downloads:",l)}},t=s=>new Promise((u,p)=>{const c=new Image;c.crossOrigin="Anonymous",c.onload=()=>{const d=document.createElement("canvas"),h=d.getContext("2d");d.width=c.width,d.height=c.height,h.drawImage(c,0,0);try{const _=d.toDataURL("image/jpeg").split(",")[1];u(_)}catch(_){p(_)}},c.onerror=p,c.src=s,c.complete&&c.onload()}),i=s=>{const u=s.split(".").pop()?.toLowerCase()||"jpeg";return{jpg:"JPEG",jpeg:"JPEG",png:"PNG",gif:"GIF",bmp:"BMP",webp:"WEBP"}[u]||"JPEG"};return n.jsx("div",{className:"flex items-center justify-center",children:n.jsx("button",{onClick:a,style:{color:r?.vcard_btn_text_color||r?.btn_text_color||"#ffffff",backgroundColor:r?.vcard_btn_bg_color||r?.btn_bg_color||"#87B88C",borderColor:r?.vcard_btn_bg_color||r?.btn_bg_color||"#87B88C"},className:"px-4 py-2.5 rounded-[10px] text-sm font-medium leading-tight w-fit",children:n.jsx(x,{text:r.contact_btn_text})})})}function S({cardPhones:r}){const{isCardReal:e,cardFormData:o}=j(),a=r?.filter(i=>!i.is_hidden),t=a&&a.length>0?a:[{label:"Sample",phone_number:"+44 1234 567890",is_hidden:!1}];return n.jsx("div",{className:"grid gap-2 grid-cols-1",children:t.map((i,s)=>n.jsxs("a",{target:"_blank",href:`tel:${i.phone_number}`,style:{color:o?.phone_text_color??o?.btn_text_color,backgroundColor:o?.phone_bg_color??o?.btn_bg_color,borderColor:o?.phone_bg_color??o?.btn_bg_color},className:"flex relative border text-sm leading-tight items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn w-full",children:[n.jsx("span",{className:"shrink-0 text-xl",children:"ðŸ“ž"}),n.jsxs("span",{children:[i.label?n.jsxs("span",{children:[n.jsx(x,{text:i.label}),": "]}):null," ",i.phone_number]}),i.is_hidden&&n.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"})]},s))})}function F({cardEmails:r}){const{isCardReal:e,cardFormData:o}=j(),a=r?.filter(i=>!i.is_hidden),t=a&&a.length>0?a:[{label:"Sample",email:"sample@email.com",is_hidden:!1}];return n.jsx("div",{className:"grid gap-2 grid-cols-1",children:t.map((i,s)=>n.jsxs("a",{target:"_blank",href:`mailto:${i.email}`,style:{color:o?.email_text_color??o?.btn_text_color,backgroundColor:o?.email_bg_color??o?.btn_bg_color,borderColor:o?.email_bg_color??o?.btn_bg_color},className:"flex border text-sm leading-tight relative items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[n.jsx("span",{className:"shrink-0 text-xl",children:"âœ‰ï¸"}),n.jsxs("span",{children:[i.label?n.jsxs("span",{children:[n.jsx(x,{text:i.label}),": "]}):null,i.email]}),i.is_hidden?n.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},s))})}function I({cardWebsites:r}){const{cardFormData:e}=j(),o=r?.filter(a=>!a.is_hidden);return o?.length?n.jsx("div",{className:"grid gap-2 grid-cols-1",children:o.map((a,t)=>n.jsxs("a",{href:a.url?.startsWith("http")?a.url:`https://${a.url}`,target:"_blank",rel:"noopener noreferrer",style:{color:e?.website_text_color??e?.btn_text_color,backgroundColor:e?.website_bg_color??e?.btn_bg_color,borderColor:e?.website_bg_color??e?.btn_bg_color},className:"flex border text-sm leading-tight relative items-center gap-3 justify-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[n.jsx("span",{className:"shrink-0 text-xl",children:a.icon?n.jsx("span",{children:a.icon}):n.jsx("span",{children:"ðŸŒ"})}),n.jsx("span",{className:"truncate",children:a.label?n.jsx("span",{children:n.jsx(x,{text:a.label})}):a.url}),a.is_hidden?n.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},t))}):null}function O({cardAddresses:r}){const{isCardReal:e,cardFormData:o}=j(),a=r?.filter(t=>!t.is_hidden);return a?.length>0?n.jsx("div",{className:"grid gap-2 grid-cols-1",children:a.map((t,i)=>t.is_hidden&&e?null:n.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:`https://www.google.de/maps/search/?api=1&query=${encodeURIComponent([t.street,t.house_number,t.zip,t.city,t.country].filter(Boolean).join(" "))}`,style:{color:o?.address_text_color??o?.btn_text_color,backgroundColor:o?.address_bg_color??o?.btn_bg_color,borderColor:o?.address_bg_color??o?.btn_bg_color},className:"flex border text-sm leading-tight relative items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[n.jsx("span",{className:"shrink-0 text-xl",children:"ðŸ“"}),n.jsx("span",{children:t.label?n.jsx("span",{children:n.jsx(x,{text:t.label})}):n.jsxs("span",{children:[[t.street,t.house_number].filter(Boolean).join(" "),t.street||t.house_number?", ":"",[t.zip,t.city].filter(Boolean).join(" "),t.zip||t.city?", ":"",t.country||""]})}),t.is_hidden?n.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},i))}):null}function U({cardButtons:r}){const{cardFormData:e}=j();return r?.length>0?n.jsx("div",{className:"grid gap-2 grid-cols-1",children:r.map((o,a)=>o.button_text&&n.jsxs("a",{target:"_blank",href:o.button_link,style:{color:e?.btn_text_color,backgroundColor:e?.btn_bg_color,borderColor:e?.btn_bg_color??"#87B88C"},className:"flex border text-sm leading-tight items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[n.jsx("span",{className:"shrink-0 text-xl",children:o.icon?o.icon:n.jsx(A,{className:"h-7 w-7"})}),n.jsx("span",{children:n.jsx(x,{text:o.button_text})})]},a))}):null}function M(){const{cardFormData:r,cardSectionsOrder:e,setCardSectionsOrder:o}=j(),a=["phoneNumbers","emails","websites","addresses","buttons"];m.useEffect(()=>{r?.company_id&&(e&&e.length>0||E.get(`/company/${r.company_id}/card-sections-order`).then(s=>{s.data.order&&Array.isArray(s.data.order)?o(s.data.order):o(a)}).catch(s=>{console.warn("âš ï¸ Failed to fetch card section order:",s),o(a)}))},[r?.company_id]);const t={phoneNumbers:n.jsx(S,{cardPhones:r?.card_phone_numbers??[]},"phoneNumbers"),emails:n.jsx(F,{cardEmails:r?.card_emails??[]},"emails"),websites:n.jsx(I,{cardWebsites:r?.card_websites??[]},"websites"),addresses:n.jsx(O,{cardAddresses:r?.card_addresses??[]},"addresses"),buttons:n.jsx(U,{cardButtons:r?.card_buttons??[]},"buttons")},i=e?.length?e:a;return n.jsx("div",{className:"space-y-2",children:i.map(s=>t[s]??null)})}function G({isReal:r=!1}){const{cardFormData:e}=j(),o=m.useRef(null),a=m.useRef(null),[t,i]=m.useState(!0);return m.useEffect(()=>{const s=()=>{if(o.current&&a.current){const u=o.current.getBoundingClientRect(),p=a.current.getBoundingClientRect();i(Math.abs(u.top-p.top)<5)}};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[e?.position,e?.department]),n.jsx("div",{className:`border ${r?"border-transparent":"border-[#EAECF0]"} rounded-lg p-3 mx-auto w-[430px] max-w-full`,style:{backgroundColor:e?.card_bg_color??"#ffffff"},children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"relative border border-[#EAECF0] bg-gradient bg-gradient-to-b from-[#eaffec] to-transparent rounded-lg w-full",children:[e.banner_image_url?n.jsx("img",{src:e.banner_image_url,alt:"Banner",className:"w-full h-full object-cover rounded-lg aspect-[2/1]"}):n.jsx("img",{src:"/assets/images/white-placeholder.webp",alt:"Banner",className:"w-full h-full object-cover rounded-lg aspect-[2/1]"}),e.profile_image_url?n.jsx("img",{src:e.profile_image_url,alt:"Profile",className:"rounded-full border-2 bg-white border-white absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2 w-[140px] h-[140px] object-cover"}):n.jsx("img",{src:"/assets/images/profile-placeholder.png",alt:"Profile",className:"rounded-full border-2 bg-white border-white absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2 w-[140px] h-[140px] object-cover"})]}),n.jsx("div",{children:n.jsxs("div",{className:"mt-20 space-y-2 text-center",children:[n.jsx("h2",{className:"text-xl text-center leading-tight font-black font-public-sans",style:{color:e?.name_text_color||"#000000"},children:e.title||e.first_name||e.last_name?`${e?.title} ${e?.first_name} ${e?.last_name}`:"Dr. John Doe"}),e.degree?n.jsx("p",{className:"text-sm italic leading-tight font-bold",style:{color:e?.name_text_color||"#000000"},children:n.jsx(x,{text:e.degree})}):null,e.position||e.department||e.company_name?n.jsxs("div",{className:"space-y-1",style:{color:e?.company_text_color||"#000000"},children:[e.position||e.department?n.jsxs("p",{className:"text-sm font-medium flex items-center justify-center flex-wrap gap-1.5 text-center",children:[e?.position&&n.jsx("span",{ref:o,children:n.jsx(x,{text:e.position})}),e?.position&&e?.department&&t&&n.jsx("span",{className:"inline-block h-1 w-1 rounded-full opacity-40",style:{backgroundColor:e?.company_text_color||"#000"}}),e?.department&&n.jsx("span",{ref:a,children:n.jsx(x,{text:e.department})})]}):null,e.company_name?n.jsx("p",{className:"text-base leading-tight font-bold",children:e.company_name}):null]}):null]})}),n.jsx(B,{}),n.jsx(T,{cardSocialsLinks:e?.card_social_links??[]}),n.jsx(M,{})]})})}function q(r,e,o={}){if(console.log("Mapping company template data for:",r,e),!r)return{};const a=r?.card_template;return{company_id:a?.company_id??null,name_text_color:a?.name_text_color??"#000000",company_name:a?.company_name??r?.name??"",contact_btn_text:a?.contact_btn_text??"Save contact details",company_text_color:a?.company_text_color??"#000000",card_bg_color:a?.card_bg_color??"#ffffff",btn_bg_color:a?.btn_bg_color??"#87B88C",btn_text_color:a?.btn_text_color??"#ffffff",phone_bg_color:a?.phone_bg_color??"#87B88C",phone_text_color:a?.phone_text_color??"#ffffff",email_bg_color:a?.email_bg_color??"#87B88C",email_text_color:a?.email_text_color??"#ffffff",address_bg_color:a?.address_bg_color??"#87B88C",address_text_color:a?.address_text_color??"#ffffff",website_bg_color:a?.website_bg_color??"#87B88C",website_text_color:a?.website_text_color??"#ffffff",contact_btn_text:a?.contact_btn_text??"Save card",vcard_btn_bg_color:a?.vcard_btn_bg_color??"#87B88C",vcard_btn_text_color:a?.vcard_btn_text_color??"#ffffff",banner_image:null,banner_image_url:a?.banner_image?`/storage/${a.banner_image}`:null,wallet_logo_image:null,wallet_logo_image_url:a?.wallet_logo_image?`/storage/${a.wallet_logo_image}`:null,wallet_text_color:a?.wallet_text_color??"#000000",wallet_bg_color:a?.wallet_bg_color??"#c4f1c8",wallet_label_1:a?.wallet_label_1??"Name",wallet_label_2:a?.wallet_label_2??"Firmenname",wallet_label_3:a?.wallet_label_3??"Titel",wallet_qr_caption:a?.wallet_qr_caption??"QR-Code scannen",wallet_title:a?.wallet_title??"Pass Name",wallet_name:a?.wallet_name??`${a?.salutation&&a.salutation.trim()!==""?a.salutation:"Mr."} ${a?.first_name&&a.first_name.trim()!==""?a.first_name:"John"} ${a?.last_name&&a.last_name.trim()!==""?a.last_name:"Doe"}`,wallet_company_name:a?.company_name??"Firmenname",wallet_position:a?.position??"Position",wallet_qr_string:"Hello there!",...e?{code:e.code??"",salutation:e.salutation??"",title:e.title??"",first_name:e.first_name??"",last_name:e.last_name??"",degree:e.degree??"",position:e.position??"",department:e.department??"",profile_image_url:e?.profile_image?`/storage/${e.profile_image}`:"/assets/images/profile-placeholder.png",profile_image:null,wallet_qr_string:e?.card_wallet?.download_link??"Hello there!",wallet_name:a?.wallet_name??`${e?.salutation&&e.salutation.trim()!==""?e.salutation:"Mr."} ${e?.first_name&&e.first_name.trim()!==""?e.first_name:"John"} ${e?.last_name&&e.last_name.trim()!==""?e.last_name:"Doe"}`,wallet_position:e?.position??"Position"}:{},card_social_links:Array.isArray(r?.card_social_links)?r.card_social_links.map(t=>({id:t.id||null,icon:t.icon||"",url:t.url||"",company_id:t.company_id||null,card_id:t.card_id||null})):[],card_phone_numbers:Array.isArray(r?.card_phone_numbers)?r.card_phone_numbers.map(t=>({id:t.id||null,phone_number:t.phone_number||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||""})):[],card_emails:Array.isArray(r?.card_emails)?r.card_emails.map(t=>({id:t.id||null,email:t.email||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||""})):[],card_addresses:Array.isArray(r?.card_addresses)?r.card_addresses.map(t=>({id:t.id||null,street:t.street||"",house_number:t.house_number||"",zip:t.zip||"",city:t.city||"",country:t.country||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||""})):[],card_buttons:Array.isArray(r?.card_buttons)?r.card_buttons.map(t=>({id:t.id||null,button_text:t.button_text||"",button_link:t.button_link||"",icon:t.icon||"",company_id:t.company_id||null,card_id:t.card_id||null})):[],card_websites:Array.isArray(r?.card_websites)?r.card_websites.map(t=>({id:t.id||null,url:t.url||"",icon:t.icon||null,is_hidden:t.is_hidden??!1,company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||""})):[]}}export{z as A,G as C,A as S,x as a,q as m};
