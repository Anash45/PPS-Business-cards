import{g as R,j as o,r as m,c as f,n as z,e as v}from"./app-EHE9T1PS.js";import{g as S}from"./viteConfig-BIBuROsR.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],C=R("smile",A);function L({cardSocialsLinks:n}){return n?.length?o.jsx("div",{className:"flex items-center gap-2 flex-wrap justify-center",children:(n||[]).map((a,s)=>a.url&&o.jsx("a",{href:a.url||"#",target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-gray-700 transition",children:a.icon?o.jsx("img",{src:`/assets/images/icons/${a.icon.replace(/^Fa/,"").toLowerCase()}.png`,alt:a.icon,className:"h-7"}):null},s))}):null}const N=m.createContext();function H({children:n}){const a=(navigator.language||"en").split("-")[0],[s,e]=m.useState(a==="de"?"de":"en"),[t,l]=m.useState(!1),r=m.useRef(null),_=[{code:"en",label:"English",flag:"/assets/images/uk.png"},{code:"de",label:"Deutsch",flag:"/assets/images/germany.png"}],d=_.find(c=>c.code===s)||_[0],u=s==="de",p=c=>{e(c),l(!1)};return m.useEffect(()=>{const c=g=>{r.current&&!r.current.contains(g.target)&&l(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),o.jsxs(N.Provider,{value:{lang:s,setLang:e,isDE:u},children:[n,o.jsx("div",{className:"fixed top-4 right-4 z-50",ref:r,children:o.jsxs("div",{className:"relative",children:[t&&o.jsx("div",{className:"absolute top-12 right-0 mb-2 w-36 rounded-2xl shadow-lg bg-white border border-gray-200 transition-all duration-150",children:_.map(c=>o.jsxs("button",{onClick:()=>p(c.code),className:`flex items-center w-full px-3 py-2 text-sm hover:bg-gray-100 ${c.code===s?"font-semibold text-primary":"text-gray-700"}`,children:[o.jsx("img",{src:c.flag,alt:c.label,className:"h-4 w-4 mr-2"}),c.label]},c.code))}),o.jsx("button",{onClick:()=>l(!t),className:"w-12 h-12 rounded-full shadow-md bg-primary text-white flex items-center justify-center text-xl hover:bg-primary focus:outline-none",title:"Change language",children:o.jsx("img",{src:d.flag,alt:d.label,className:"h-6 w-6 rounded-full"})})]})})]})}function h(){return m.useContext(N)}function B(){const{cardFormData:n}=f(),s=h()?.isDE||null,[e,t]=m.useState("https://app.ppsbusinesscards.de");m.useEffect(()=>{(async()=>{const d=await S();t(d)})()},[]);const l=async()=>{if(!n)return;console.log("cardFormData: ",n);const d=n.first_name||"",u=n.last_name||"",p=n.company_name||"";let c=`BEGIN:VCARD
VERSION:3.0
N:${u};${d};;${n.title||""};
FN:${[n.salutation,d,u].filter(Boolean).join(" ")}
ORG:${p}
TITLE:${n.position||""}
ROLE:${n.department||""}
`;if(n.profile_image_url)try{const i=await r(`${e}${n.profile_image_url}`);if(i){const x=_(n.profile_image_url);c+=`PHOTO;ENCODING=b;TYPE=${x}:${i}
`}}catch(i){console.warn("Failed to convert image to base64, falling back to URL:",i),c+=`PHOTO;VALUE=URI:${e}${n.profile_image_url}
`}(n.card_websites||[]).forEach(i=>{i.url&&(i.label?c+=`URL;TYPE=${i.label.toUpperCase()}:${i.url}
`:c+=`URL:${i.url}
`)}),(n.card_phone_numbers||[]).forEach((i,x)=>{if(i.phone_number){const y=(i.type||"Work").toUpperCase();c+=`TEL;TYPE=${x===0?"PREF,":""}${y},VOICE:${i.phone_number}
`}}),(n.card_emails||[]).forEach((i,x)=>{if(i.email){const y=(i.type||"Work").toUpperCase();c+=`EMAIL;TYPE=${x===0?"PREF,":""}${y}:${i.email}
`}}),(n.card_addresses||[]).forEach((i,x)=>{if(i.street||i.house_number||i.city||i.country){const y=(i.type||"Work").toUpperCase(),j=x===0?"PREF,":"",$=[i.street,i.house_number].join(" "),k=i.city||"",D=i.zip||"",P=i.country||"";c+=`ADR;TYPE=${j}${y}:;;${$};${k};;${D};${P}
`}}),c+="END:VCARD";const g=new Blob([c],{type:"text/vcard;charset=utf-8"}),w=URL.createObjectURL(g),b=document.createElement("a"),E=p.replace(/\s+/g,"_");b.download=`${d}_${u}_${E}.vcf`,b.href=w,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(w),z.success("vCard downloaded!");try{const i=await v.post("/cards/increment-downloads",{code:n.code});i.data.success?console.log("Downloads updated:",i.data.downloads):console.warn("Download increment failed:",i.data.message)}catch(i){console.error("Error incrementing downloads:",i)}},r=d=>new Promise((u,p)=>{const c=new Image;c.crossOrigin="Anonymous",c.onload=()=>{const g=document.createElement("canvas"),w=g.getContext("2d");g.width=c.width,g.height=c.height,w.drawImage(c,0,0);try{const b=g.toDataURL("image/jpeg").split(",")[1];u(b)}catch(b){p(b)}},c.onerror=p,c.src=d,c.complete&&c.onload()}),_=d=>{const u=d.split(".").pop()?.toLowerCase()||"jpeg";return{jpg:"JPEG",jpeg:"JPEG",png:"PNG",gif:"GIF",bmp:"BMP",webp:"WEBP"}[u]||"JPEG"};return o.jsx("div",{className:"flex items-center justify-center",children:o.jsx("button",{onClick:l,style:{color:n?.vcard_btn_text_color||n?.btn_text_color||"#ffffff",backgroundColor:n?.vcard_btn_bg_color||n?.btn_bg_color||"#87B88C",borderColor:n?.vcard_btn_bg_color||n?.btn_bg_color||"#87B88C"},className:"px-4 py-2.5 rounded-[10px] text-sm font-medium leading-tight w-fit",children:s&&n.contact_btn_text_de?n.contact_btn_text_de:n.contact_btn_text})})}function F({cardPhones:n}){const s=h()?.isDE||null,{isCardReal:e,cardFormData:t}=f(),l=n?.filter(_=>!_.is_hidden),r=l&&l.length>0?l:[{icon:"ðŸ“ž",label:"Sample",phone_number:"+44 1234 567890",is_hidden:!1}];return o.jsx("div",{className:"grid gap-2 grid-cols-1",children:r.map((_,d)=>o.jsxs("a",{target:"_blank",href:`tel:${_.phone_number}`,style:{color:t?.phone_text_color??t?.btn_text_color,backgroundColor:t?.phone_bg_color??t?.btn_bg_color,borderColor:t?.phone_bg_color??t?.btn_bg_color,fontSize:`${t.buttons_size}px`},className:"flex relative border leading-tight items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn w-full",children:[o.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(t.buttons_size)+4}px`},children:_?.icon??"ðŸ“ž"}),o.jsxs("span",{children:[_.label||_.label_de?o.jsx("span",{children:s&&_.label_de?_.label_de:_.label}):null," ",_.phone_number]}),_.is_hidden&&o.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"})]},d))})}function T({cardEmails:n}){const s=h()?.isDE||null,{isCardReal:e,cardFormData:t}=f(),l=n?.filter(_=>!_.is_hidden),r=l&&l.length>0?l:[{label:"Sample",email:"sample@email.com",is_hidden:!1}];return o.jsx("div",{className:"grid gap-2 grid-cols-1",children:r.map((_,d)=>o.jsxs("a",{target:"_blank",href:`mailto:${_.email}`,style:{color:t?.email_text_color??t?.btn_text_color,backgroundColor:t?.email_bg_color??t?.btn_bg_color,borderColor:t?.email_bg_color??t?.btn_bg_color,fontSize:`${t.buttons_size}px`},className:"flex border leading-tight relative items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[o.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(t.buttons_size)+4}px`},children:"âœ‰ï¸"}),o.jsxs("span",{children:[_.label||_.label_de?o.jsx("span",{children:s&&_.label_de?_.label_de:_.label}):null,_.email]}),_.is_hidden?o.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},d))})}function O({cardWebsites:n}){const s=h()?.isDE||null,{cardFormData:e}=f(),t=n?.filter(l=>!l.is_hidden);return t?.length?o.jsx("div",{className:"grid gap-2 grid-cols-1",children:t.map((l,r)=>o.jsxs("a",{href:l.url?.startsWith("http")?l.url:`https://${l.url}`,target:"_blank",rel:"noopener noreferrer",style:{color:e?.website_text_color??e?.btn_text_color,backgroundColor:e?.website_bg_color??e?.btn_bg_color,borderColor:e?.website_bg_color??e?.btn_bg_color,fontSize:`${e.buttons_size}px`},className:"flex border leading-tight relative items-center gap-3 justify-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[o.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(e.buttons_size)+4}px`},children:l.icon?o.jsx("span",{children:l.icon}):o.jsx("span",{children:"ðŸŒ"})}),o.jsx("span",{className:"truncate",children:l.label||l.label_de?o.jsx("span",{children:s&&l.label_de?l.label_de:l.label}):l.url}),l.is_hidden?o.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},r))}):null}function I({cardAddresses:n}){const{isCardReal:a,cardFormData:s}=f(),t=h()?.isDE||null,l=n?.filter(r=>!r.is_hidden);return l?.length>0?o.jsx("div",{className:"grid gap-2 grid-cols-1",children:l.map((r,_)=>r.is_hidden&&a?null:o.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:`https://www.google.de/maps/search/?api=1&query=${encodeURIComponent([r.street,r.house_number,r.zip,r.city,r.country].filter(Boolean).join(" "))}`,style:{color:s?.address_text_color??s?.btn_text_color,backgroundColor:s?.address_bg_color??s?.btn_bg_color,borderColor:s?.address_bg_color??s?.btn_bg_color,fontSize:`${s.buttons_size}px`},className:"flex border leading-tight relative items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[o.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(s.buttons_size)+4}px`},children:"ðŸ“"}),o.jsx("span",{children:r.label||r.label_de?o.jsx("span",{children:t&&r.label_de?r.label_de:r.label}):o.jsxs("span",{children:[[r.street,r.house_number].filter(Boolean).join(" "),r.street||r.house_number?", ":"",[r.zip,r.city].filter(Boolean).join(" "),r.zip||r.city?", ":"",r.country||""]})}),r.is_hidden?o.jsx("span",{className:"absolute -translate-y-1/2 translate-x-1 top-0 right-0 text-[10px] rounded bg-orange-500 py-0.5 px-2 italic text-white",children:"(Hidden)"}):null]},_))}):null}function U({cardButtons:n}){const s=h()?.isDE||null,{cardFormData:e}=f();return n?.length>0?o.jsx("div",{className:"grid gap-2 grid-cols-1",children:n.map((t,l)=>t.button_text&&o.jsxs("a",{target:"_blank",href:t.button_link,style:{color:e?.btn_text_color,backgroundColor:e?.btn_bg_color,borderColor:e?.btn_bg_color??"#87B88C",fontSize:`${e.buttons_size}px`},className:"flex border leading-tight items-center gap-3 justify-content-start rounded-lg px-4 py-2.5 font-medium preview-btn",children:[o.jsx("span",{className:"shrink-0",style:{fontSize:`${Number(e.buttons_size)+4}px`},children:t.icon?t.icon:o.jsx(C,{className:"h-7 w-7"})}),o.jsx("span",{children:s&&t.button_text_de?t.button_text_de:t.button_text})]},l))}):null}function M(){const{cardFormData:n,cardSectionsOrder:a,setCardSectionsOrder:s}=f(),e=["phoneNumbers","emails","websites","addresses","buttons"];m.useEffect(()=>{n?.company_id&&(a&&a.length>0||v.get(`/company/${n.company_id}/card-sections-order`).then(r=>{r.data.order&&Array.isArray(r.data.order)?s(r.data.order):s(e)}).catch(r=>{console.warn("âš ï¸ Failed to fetch card section order:",r),s(e)}))},[n?.company_id]);const t={phoneNumbers:o.jsx(F,{cardPhones:n?.card_phone_numbers??[]},"phoneNumbers"),emails:o.jsx(T,{cardEmails:n?.card_emails??[]},"emails"),websites:o.jsx(O,{cardWebsites:n?.card_websites??[]},"websites"),addresses:o.jsx(I,{cardAddresses:n?.card_addresses??[]},"addresses"),buttons:o.jsx(U,{cardButtons:n?.card_buttons??[]},"buttons")},l=a?.length?a:e;return o.jsx("div",{className:"space-y-2",children:l.map(r=>t[r]??null)})}function V({isReal:n=!1}){const s=h()?.isDE||null,{cardFormData:e}=f(),t=m.useRef(null),l=m.useRef(null),[r,_]=m.useState(!0);return m.useEffect(()=>{const d=()=>{if(t.current&&l.current){const u=t.current.getBoundingClientRect(),p=l.current.getBoundingClientRect();_(Math.abs(u.top-p.top)<5)}};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[e?.position,e?.department]),o.jsx("div",{className:`border ${n?"border-transparent":"border-[#EAECF0]"} rounded-lg p-3 mx-auto w-[430px] max-w-full`,style:{backgroundColor:e?.card_bg_color??"#ffffff"},children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"relative border border-[#EAECF0] bg-gradient bg-gradient-to-b from-[#eaffec] to-transparent rounded-lg w-full",children:[e.banner_image_url?o.jsx("img",{src:e.banner_image_url,alt:"Banner",className:"w-full h-full object-cover rounded-lg aspect-[2/1]"}):o.jsx("img",{src:"/assets/images/white-placeholder.webp",alt:"Banner",className:"w-full h-full object-cover rounded-lg aspect-[2/1]"}),e.profile_image_url?o.jsx("img",{src:e.profile_image_url,alt:"Profile",className:"rounded-full border-2 bg-white border-white absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2 w-[140px] h-[140px] object-cover"}):o.jsx("img",{src:"/assets/images/profile-placeholder.png",alt:"Profile",className:"rounded-full border-2 bg-white border-white absolute bottom-0 left-1/2 transform translate-y-1/2 -translate-x-1/2 w-[140px] h-[140px] object-cover"})]}),o.jsx("div",{children:o.jsxs("div",{className:"mt-20 space-y-2 text-center",children:[o.jsx("h2",{className:"text-xl text-center leading-tight font-black font-public-sans",style:{color:e?.name_text_color||"#000000"},children:e.title||e.first_name||e.last_name?`${e?.title} ${e?.first_name} ${e?.last_name}`:"Dr. John Doe"}),e.degree||e.degree_de?o.jsx("p",{className:"text-sm italic leading-tight font-bold",style:{color:e?.name_text_color||"#000000"},children:s&&e.degree_de?e.degree_de:e.degree}):null,(e.position||e.department||e.company_name)&&o.jsxs("div",{className:"space-y-1",style:{color:e?.company_text_color||"#000000"},children:[(e.position||e.department)&&o.jsxs("p",{className:"text-sm font-medium flex items-center justify-center flex-wrap gap-1.5 text-center",children:[s&&e.position_de||e.position?o.jsx("span",{ref:t,children:s&&e.position_de?e.position_de:e.position}):null,(s&&e.position_de||e.position)&&(s&&e.department_de||e.department)&&r?o.jsx("span",{className:"inline-block h-1 w-1 rounded-full opacity-40",style:{backgroundColor:e?.company_text_color||"#000"}}):null,s&&e.department_de||e.department?o.jsx("span",{ref:l,children:s&&e.department_de?e.department_de:e.department}):null]}),e.company_name&&o.jsx("p",{className:"text-base leading-tight font-bold",dangerouslySetInnerHTML:{__html:e.company_name.replace(/\r?\n/g,"<br>")}})]})]})}),o.jsx(B,{}),o.jsx(L,{cardSocialsLinks:e?.card_social_links??[]}),o.jsx(M,{})]})})}function J(n,a,s={}){if(console.log("Mapping company template data for:",n,a),!n)return{};const e=n?.card_template;return{company_id:e?.company_id??null,name_text_color:e?.name_text_color??"#000000",company_name:e?.company_name??n?.name??"",contact_btn_text:e?.contact_btn_text??"Save contact details",contact_btn_text_de:e?.contact_btn_text_de??"Kontaktdaten speichern",company_text_color:e?.company_text_color??"#000000",card_bg_color:e?.card_bg_color??"#ffffff",btn_bg_color:e?.btn_bg_color??"#87B88C",btn_text_color:e?.btn_text_color??"#ffffff",phone_bg_color:e?.phone_bg_color??"#87B88C",phone_text_color:e?.phone_text_color??"#ffffff",email_bg_color:e?.email_bg_color??"#87B88C",email_text_color:e?.email_text_color??"#ffffff",address_bg_color:e?.address_bg_color??"#87B88C",address_text_color:e?.address_text_color??"#ffffff",website_bg_color:e?.website_bg_color??"#87B88C",website_text_color:e?.website_text_color??"#ffffff",contact_btn_text:e?.contact_btn_text??"Save card",vcard_btn_bg_color:e?.vcard_btn_bg_color??"#87B88C",vcard_btn_text_color:e?.vcard_btn_text_color??"#ffffff",buttons_size:e?.buttons_size??"14",banner_image:null,banner_image_url:e?.banner_image?`/storage/${e.banner_image}`:null,wallet_logo_image:null,wallet_logo_image_url:e?.wallet_logo_image?`/storage/${e.wallet_logo_image}`:null,wallet_text_color:e?.wallet_text_color??"#000000",wallet_bg_color:e?.wallet_bg_color??"#c4f1c8",wallet_label_1:e?.wallet_label_1??"Name",wallet_label_2:e?.wallet_label_2??"Firmenname",wallet_label_3:e?.wallet_label_3??"Titel",wallet_qr_caption:e?.wallet_qr_caption??"QR-Code scannen",wallet_title:e?.wallet_title??"Pass Name",wallet_name:e?.wallet_name??`${e?.salutation&&e.salutation.trim()!==""?e.salutation:"Mr."} ${e?.first_name&&e.first_name.trim()!==""?e.first_name:"John"} ${e?.last_name&&e.last_name.trim()!==""?e.last_name:"Doe"}`,wallet_company_name:e?.company_name??"Firmenname",wallet_position:e?.position??"Position",wallet_qr_string:"Hello there!",...a?{code:a.code??"",salutation:a.salutation??"",title:a.title??"",first_name:a.first_name??"",last_name:a.last_name??"",degree:a.degree??"",degree_de:a.degree_de??"",position:a.position??"",position_de:a.position_de??"",department:a.department??"",department_de:a.department_de??"",profile_image_url:a?.profile_image?`/storage/${a.profile_image}`:"/assets/images/profile-placeholder.png",profile_image:null,wallet_qr_string:a?.card_wallet?.download_link??"Hello there!",wallet_name:e?.wallet_name??`${a?.salutation&&a.salutation.trim()!==""?a.salutation:"Mr."} ${a?.first_name&&a.first_name.trim()!==""?a.first_name:"John"} ${a?.last_name&&a.last_name.trim()!==""?a.last_name:"Doe"}`,wallet_position:a?.position??"Position"}:{},card_social_links:Array.isArray(n?.card_social_links)?n.card_social_links.map(t=>({id:t.id||null,icon:t.icon||"",url:t.url||"",company_id:t.company_id||null,card_id:t.card_id||null})):[],card_phone_numbers:Array.isArray(n?.card_phone_numbers)?n.card_phone_numbers.map(t=>({id:t.id||null,icon:t.icon||"",phone_number:t.phone_number||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||"",label_de:t.label_de||""})):[],card_emails:Array.isArray(n?.card_emails)?n.card_emails.map(t=>({id:t.id||null,email:t.email||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||"",label_de:t.label_de||""})):[],card_addresses:Array.isArray(n?.card_addresses)?n.card_addresses.map(t=>({id:t.id||null,street:t.street||"",house_number:t.house_number||"",zip:t.zip||"",city:t.city||"",country:t.country||"",is_hidden:t.is_hidden??!1,type:t.type??"Work",company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||"",label_de:t.label_de||""})):[],card_buttons:Array.isArray(n?.card_buttons)?n.card_buttons.map(t=>({id:t.id||null,button_text:t.button_text||"",button_text_de:t.button_text_de||"",button_link:t.button_link||"",icon:t.icon||"",company_id:t.company_id||null,card_id:t.card_id||null})):[],card_websites:Array.isArray(n?.card_websites)?n.card_websites.map(t=>({id:t.id||null,url:t.url||"",icon:t.icon||null,is_hidden:t.is_hidden??!1,company_id:t.company_id||null,card_id:t.card_id||null,label:t.label||"",label_de:t.label_de||""})):[]}}export{H as A,V as C,C as S,J as m,h as u};
